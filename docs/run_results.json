{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-05-14T15:34:07.146376Z", "invocation_id": "33000a2f-2f65-4f8a-bf12-c43422e886e9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.185694Z", "completed_at": "2024-05-14T15:33:59.187833Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.194226Z", "completed_at": "2024-05-14T15:33:59.194244Z"}], "thread_id": "Thread-2", "execution_time": 0.025797128677368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_mobile_integration_tests.snowplow_mobile_events", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.188481Z", "completed_at": "2024-05-14T15:33:59.190536Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.195251Z", "completed_at": "2024-05-14T15:33:59.195259Z"}], "thread_id": "Thread-3", "execution_time": 0.025480985641479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_mobile_integration_tests.snowplow_mobile_screen_views_expected", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.191293Z", "completed_at": "2024-05-14T15:33:59.193573Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.196201Z", "completed_at": "2024-05-14T15:33:59.196211Z"}], "thread_id": "Thread-4", "execution_time": 0.025762081146240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_mobile_integration_tests.snowplow_mobile_sessions_expected", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.171802Z", "completed_at": "2024-05-14T15:33:59.197110Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.198840Z", "completed_at": "2024-05-14T15:33:59.198850Z"}], "thread_id": "Thread-1", "execution_time": 0.032318830490112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_incremental_manifest", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n        with prep as (\n        select\n            cast(null as \n    TEXT\n) model,\n            cast('1970-01-01' as timestamp) as last_success\n        )\n\n        select *\n\n        from prep\n        where false\n    ", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_incremental_manifest"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.205896Z", "completed_at": "2024-05-14T15:33:59.207983Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.215571Z", "completed_at": "2024-05-14T15:33:59.215582Z"}], "thread_id": "Thread-2", "execution_time": 0.015270709991455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_mobile_integration_tests.snowplow_mobile_users_expected", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.209953Z", "completed_at": "2024-05-14T15:33:59.224461Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.226102Z", "completed_at": "2024-05-14T15:33:59.226110Z"}], "thread_id": "Thread-3", "execution_time": 0.02366042137145996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile_integration_tests.snowplow_mobile_events_stg", "compiled": true, "compiled_code": "\n\n/* page view context is given as json string in csv. Had to flatten it first to be able to rename the keys as the loader/transformer\nleaves the fields in camel case for Snowflake unlike for other warehouses. Parse json */\n\nwith prep as (\n  select\n    app_id,\n    platform,\n    etl_tstamp,\n    collector_tstamp,\n    dvce_created_tstamp,\n    event,\n    event_id,\n    txn_id,\n    name_tracker,\n    v_tracker,\n    v_collector,\n    v_etl,\n    user_id,\n    user_ipaddress,\n    user_fingerprint,\n    domain_userid,\n    domain_sessionidx,\n    network_userid,\n    geo_country,\n    geo_region,\n    geo_city,\n    geo_zipcode,\n    geo_latitude,\n    geo_longitude,\n    geo_region_name,\n    ip_isp,\n    ip_organization,\n    ip_domain,\n    ip_netspeed,\n    page_url,\n    page_title,\n    page_referrer,\n    page_urlscheme,\n    page_urlhost,\n    page_urlport,\n    page_urlpath,\n    page_urlquery,\n    page_urlfragment,\n    refr_urlscheme,\n    refr_urlhost,\n    refr_urlport,\n    refr_urlpath,\n    refr_urlquery,\n    refr_urlfragment,\n    refr_medium,\n    refr_source,\n    refr_term,\n    mkt_medium,\n    mkt_source,\n    mkt_term,\n    mkt_content,\n    mkt_campaign,\n    se_category,\n    se_action,\n    se_label,\n    se_property,\n    se_value,\n    tr_orderid,\n    tr_affiliation,\n    tr_total,\n    tr_tax,\n    tr_shipping,\n    tr_city,\n    tr_state,\n    tr_country,\n    ti_orderid,\n    ti_sku,\n    ti_name,\n    ti_category,\n    ti_price,\n    ti_quantity,\n    pp_xoffset_min,\n    pp_xoffset_max,\n    pp_yoffset_min,\n    pp_yoffset_max,\n    useragent,\n    br_name,\n    br_family,\n    br_version,\n    br_type,\n    br_renderengine,\n    br_lang,\n    br_features_pdf,\n    br_features_flash,\n    br_features_java,\n    br_features_director,\n    br_features_quicktime,\n    br_features_realplayer,\n    br_features_windowsmedia,\n    br_features_gears,\n    br_features_silverlight,\n    br_cookies,\n    br_colordepth,\n    br_viewwidth,\n    br_viewheight,\n    os_name,\n    os_family,\n    os_manufacturer,\n    os_timezone,\n    dvce_type,\n    dvce_ismobile,\n    dvce_screenwidth,\n    dvce_screenheight,\n    doc_charset,\n    doc_width,\n    doc_height,\n    tr_currency,\n    tr_total_base,\n    tr_tax_base,\n    tr_shipping_base,\n    ti_currency,\n    ti_price_base,\n    base_currency,\n    geo_timezone,\n    mkt_clickid,\n    mkt_network,\n    etl_tags,\n    dvce_sent_tstamp,\n    refr_domain_userid,\n    refr_dvce_tstamp,\n    domain_sessionid,\n    derived_tstamp,\n    event_vendor,\n    event_name,\n    event_format,\n    event_version,\n    event_fingerprint,\n    true_tstamp,\n    parse_json(unstruct_event_com_snowplowanalytics_mobile_screen_view_1_0_0) as unstruct_event_com_snowplowanalytics_mobile_screen_view_1,\n    parse_json(contexts_com_snowplowanalytics_snowplow_client_session_1_0_1) as contexts_com_snowplowanalytics_snowplow_client_session_1,\n    parse_json(contexts_com_snowplowanalytics_snowplow_geolocation_context_1_1_0) as contexts_com_snowplowanalytics_snowplow_geolocation_context_1\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_events\n)\n\n, flatten as (\n\n  select\n    app_id,\n    platform,\n    etl_tstamp,\n    collector_tstamp,\n    dvce_created_tstamp,\n    event,\n    event_id,\n    txn_id,\n    name_tracker,\n    v_tracker,\n    v_collector,\n    v_etl,\n    user_id,\n    user_ipaddress,\n    user_fingerprint,\n    domain_userid,\n    domain_sessionidx,\n    network_userid,\n    geo_country,\n    geo_region,\n    geo_city,\n    geo_zipcode,\n    geo_latitude,\n    geo_longitude,\n    geo_region_name,\n    ip_isp,\n    ip_organization,\n    ip_domain,\n    ip_netspeed,\n    page_url,\n    page_title,\n    page_referrer,\n    page_urlscheme,\n    page_urlhost,\n    page_urlport,\n    page_urlpath,\n    page_urlquery,\n    page_urlfragment,\n    refr_urlscheme,\n    refr_urlhost,\n    refr_urlport,\n    refr_urlpath,\n    refr_urlquery,\n    refr_urlfragment,\n    refr_medium,\n    refr_source,\n    refr_term,\n    mkt_medium,\n    mkt_source,\n    mkt_term,\n    mkt_content,\n    mkt_campaign,\n    se_category,\n    se_action,\n    se_label,\n    se_property,\n    se_value,\n    tr_orderid,\n    tr_affiliation,\n    tr_total,\n    tr_tax,\n    tr_shipping,\n    tr_city,\n    tr_state,\n    tr_country,\n    ti_orderid,\n    ti_sku,\n    ti_name,\n    ti_category,\n    ti_price,\n    ti_quantity,\n    pp_xoffset_min,\n    pp_xoffset_max,\n    pp_yoffset_min,\n    pp_yoffset_max,\n    useragent,\n    br_name,\n    br_family,\n    br_version,\n    br_type,\n    br_renderengine,\n    br_lang,\n    br_features_pdf,\n    br_features_flash,\n    br_features_java,\n    br_features_director,\n    br_features_quicktime,\n    br_features_realplayer,\n    br_features_windowsmedia,\n    br_features_gears,\n    br_features_silverlight,\n    br_cookies,\n    br_colordepth,\n    br_viewwidth,\n    br_viewheight,\n    os_name,\n    os_family,\n    os_manufacturer,\n    os_timezone,\n    dvce_type,\n    dvce_ismobile,\n    dvce_screenwidth,\n    dvce_screenheight,\n    doc_charset,\n    doc_width,\n    doc_height,\n    tr_currency,\n    tr_total_base,\n    tr_tax_base,\n    tr_shipping_base,\n    ti_currency,\n    ti_price_base,\n    base_currency,\n    geo_timezone,\n    mkt_clickid,\n    mkt_network,\n    etl_tags,\n    dvce_sent_tstamp,\n    refr_domain_userid,\n    refr_dvce_tstamp,\n    domain_sessionid,\n    derived_tstamp,\n    event_vendor,\n    event_name,\n    event_format,\n    event_version,\n    event_fingerprint,\n    true_tstamp,\n    unstruct_event_com_snowplowanalytics_mobile_screen_view_1[0]:id::varchar AS id,\n    unstruct_event_com_snowplowanalytics_mobile_screen_view_1[0]:name::varchar AS name,\n    unstruct_event_com_snowplowanalytics_mobile_screen_view_1[0]:previous_id::varchar AS previousId,\n    unstruct_event_com_snowplowanalytics_mobile_screen_view_1[0]:previous_name::varchar AS previousName,\n    unstruct_event_com_snowplowanalytics_mobile_screen_view_1[0]:previous_type::varchar AS previousType,\n    unstruct_event_com_snowplowanalytics_mobile_screen_view_1[0]:transition_type::varchar AS transitionType,\n    unstruct_event_com_snowplowanalytics_mobile_screen_view_1[0]:type::varchar AS type,\n    contexts_com_snowplowanalytics_snowplow_client_session_1[0]:first_event_id::varchar AS firstEventId,\n    contexts_com_snowplowanalytics_snowplow_client_session_1[0]:previous_session_id::varchar AS previousSessionId,\n    contexts_com_snowplowanalytics_snowplow_client_session_1[0]:session_id::varchar AS sessionId,\n    contexts_com_snowplowanalytics_snowplow_client_session_1[0]:session_index::varchar AS sessionIndex,\n    contexts_com_snowplowanalytics_snowplow_client_session_1[0]:user_id::varchar AS userId,\n    contexts_com_snowplowanalytics_snowplow_client_session_1[0]:event_index::varchar AS eventIndex,\n    contexts_com_snowplowanalytics_snowplow_client_session_1[0]:storage_mechanism::varchar AS storageMechanism,\n    contexts_com_snowplowanalytics_snowplow_client_session_1[0]:first_event_timestamp::varchar AS firstEventTimestamp,\n    contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:latitude::float AS latitude,\n    contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:longitude::float AS longitude,\n    contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:latitude_longitude_accuracy::float AS latitudeLongitudeAccuracy,\n    contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:altitude::float AS altitude,\n    contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:altitude_accuracy::float AS altitudeAccuracy,\n    contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:bearing::float AS bearing,\n    contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:speed::float AS speed,\n    contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:timestamp::int AS timestamp\n\nfrom prep\n)\n\nselect\n  app_id,\n    platform,\n    etl_tstamp,\n    collector_tstamp,\n    dvce_created_tstamp,\n    event,\n    event_id,\n    txn_id,\n    name_tracker,\n    v_tracker,\n    v_collector,\n    v_etl,\n    user_id,\n    user_ipaddress,\n    user_fingerprint,\n    domain_userid,\n    domain_sessionidx,\n    network_userid,\n    geo_country,\n    geo_region,\n    geo_city,\n    geo_zipcode,\n    geo_latitude,\n    geo_longitude,\n    geo_region_name,\n    ip_isp,\n    ip_organization,\n    ip_domain,\n    ip_netspeed,\n    page_url,\n    page_title,\n    page_referrer,\n    page_urlscheme,\n    page_urlhost,\n    page_urlport,\n    page_urlpath,\n    page_urlquery,\n    page_urlfragment,\n    refr_urlscheme,\n    refr_urlhost,\n    refr_urlport,\n    refr_urlpath,\n    refr_urlquery,\n    refr_urlfragment,\n    refr_medium,\n    refr_source,\n    refr_term,\n    mkt_medium,\n    mkt_source,\n    mkt_term,\n    mkt_content,\n    mkt_campaign,\n    se_category,\n    se_action,\n    se_label,\n    se_property,\n    se_value,\n    tr_orderid,\n    tr_affiliation,\n    tr_total,\n    tr_tax,\n    tr_shipping,\n    tr_city,\n    tr_state,\n    tr_country,\n    ti_orderid,\n    ti_sku,\n    ti_name,\n    ti_category,\n    ti_price,\n    ti_quantity,\n    pp_xoffset_min,\n    pp_xoffset_max,\n    pp_yoffset_min,\n    pp_yoffset_max,\n    useragent,\n    br_name,\n    br_family,\n    br_version,\n    br_type,\n    br_renderengine,\n    br_lang,\n    br_features_pdf,\n    br_features_flash,\n    br_features_java,\n    br_features_director,\n    br_features_quicktime,\n    br_features_realplayer,\n    br_features_windowsmedia,\n    br_features_gears,\n    br_features_silverlight,\n    br_cookies,\n    br_colordepth,\n    br_viewwidth,\n    br_viewheight,\n    os_name,\n    os_family,\n    os_manufacturer,\n    os_timezone,\n    dvce_type,\n    dvce_ismobile,\n    dvce_screenwidth,\n    dvce_screenheight,\n    doc_charset,\n    doc_width,\n    doc_height,\n    tr_currency,\n    tr_total_base,\n    tr_tax_base,\n    tr_shipping_base,\n    ti_currency,\n    ti_price_base,\n    base_currency,\n    geo_timezone,\n    mkt_clickid,\n    mkt_network,\n    etl_tags,\n    dvce_sent_tstamp,\n    refr_domain_userid,\n    refr_dvce_tstamp,\n    domain_sessionid,\n    derived_tstamp,\n    event_vendor,\n    event_name,\n    event_format,\n    event_version,\n    event_fingerprint,\n    true_tstamp,\n    object_construct('id',id,'name',name,'previousId',previousId,'previousName',previousName,'previousType',previousType,'transitionType',transitionType,'type',type) as unstruct_event_com_snowplowanalytics_mobile_screen_view_1,\n    parse_json('[{\"firstEventId\":\"'||firstEventId||'\", \"previousSessionId\":\"'||previousSessionId||'\", \"sessionId\":\"'||sessionId||'\", \"sessionIndex\":\"'||sessionIndex||'\", \"userId\":\"'||userId||'\", \"eventIndex\":\"'||eventIndex||'\", \"storageMechanism\":\"'||storageMechanism||'\", \"firstEventTimestamp\":\"'||firstEventTimestamp||'\"}]' ) as contexts_com_snowplowanalytics_snowplow_client_session_1,\n    to_variant([OBJECT_CONSTRUCT_KEEP_NULL('latitude', latitude, 'longitude', longitude, 'latitudeLongitudeAccuracy', latitudeLongitudeAccuracy, 'altitude', altitude, 'altitudeAccuracy', altitudeAccuracy, 'bearing', bearing,'speed', speed,'timestamp', timestamp)]) as contexts_com_snowplowanalytics_snowplow_geolocation_context_1\n\nfrom flatten\n\nwhere \n  user_id not in (\n    'NULL device_user_id' -- Case when `device_user_id` is null but `session_id` is not null. Shouldn't happen. Will solve if it arises.\n    )\n --filter out any edge cases we havent yet solved for but are included in the test dataset.", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_events_stg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.216568Z", "completed_at": "2024-05-14T15:33:59.227005Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.229627Z", "completed_at": "2024-05-14T15:33:59.229635Z"}], "thread_id": "Thread-4", "execution_time": 0.02576446533203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile_integration_tests.snowplow_mobile_screen_views_expected_stg", "compiled": true, "compiled_code": "\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_screen_views_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_screen_views_expected_stg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.219892Z", "completed_at": "2024-05-14T15:33:59.228959Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.240132Z", "completed_at": "2024-05-14T15:33:59.240140Z"}], "thread_id": "Thread-1", "execution_time": 0.03562355041503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile_integration_tests.snowplow_mobile_sessions_expected_stg", "compiled": true, "compiled_code": "\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_sessions_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_sessions_expected_stg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.245154Z", "completed_at": "2024-05-14T15:33:59.258538Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.330546Z", "completed_at": "2024-05-14T15:33:59.330562Z"}], "thread_id": "Thread-3", "execution_time": 0.0914609432220459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.snowplow_mobile.snowplow_mobile-on-run-start-0", "compiled": true, "compiled_code": "\n\n  \n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.253440Z", "completed_at": "2024-05-14T15:33:59.337675Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.338439Z", "completed_at": "2024-05-14T15:33:59.338447Z"}], "thread_id": "Thread-4", "execution_time": 0.09473419189453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_incremental_manifest_model.7316d2c3cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_incremental_manifest\nwhere model is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.334145Z", "completed_at": "2024-05-14T15:33:59.339568Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.340809Z", "completed_at": "2024-05-14T15:33:59.340816Z"}], "thread_id": "Thread-3", "execution_time": 0.008235931396484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile_integration_tests.snowplow_mobile_users_expected_stg", "compiled": true, "compiled_code": "\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_users_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_users_expected_stg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.320633Z", "completed_at": "2024-05-14T15:33:59.340217Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.341785Z", "completed_at": "2024-05-14T15:33:59.341793Z"}], "thread_id": "Thread-1", "execution_time": 0.09304070472717285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_incremental_manifest_model.d211d2053e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    model as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_incremental_manifest\nwhere model is not null\ngroup by model\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:33:59.230532Z", "completed_at": "2024-05-14T15:33:59.983327Z"}, {"name": "execute", "started_at": "2024-05-14T15:33:59.983963Z", "completed_at": "2024-05-14T15:33:59.983975Z"}], "thread_id": "Thread-2", "execution_time": 0.9728808403015137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_base_new_event_limits", "compiled": true, "compiled_code": "\n\n\n      select\n        \n\n    dateadd(\n        hour,\n        -6,\n        \n        cast('2021-04-21 13:50:44.234000' as timestamp)\n    \n        )\n\n as lower_limit,\n        least(\n\n    dateadd(\n        day,\n        20,\n        \n        cast('2021-04-21 13:50:44.234000' as timestamp)\n    \n        )\n\n,\n              \n    convert_timezone('UTC', convert_timezone('UTC', current_timestamp()))::timestamp\n) as upper_limit\n    ", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_new_event_limits"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:00.202087Z", "completed_at": "2024-05-14T15:34:01.167340Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:01.168001Z", "completed_at": "2024-05-14T15:34:01.168014Z"}], "thread_id": "Thread-4", "execution_time": 1.1694526672363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_base_sessions_lifecycle_manifest", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n        with new_events_session_ids_init as (\n            select\n            \n                COALESCE(\n                    \ne.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:sessionId::TEXT\n,NULL\n                ) as session_identifier,\n                max(\n                    COALESCE(\n                        \ne.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:userId::TEXT\n,NULL\n                    )\n                ) as user_identifier, -- Edge case 1: Arbitary selection to avoid window function like first_value.\n            \n                min(collector_tstamp) as start_tstamp,\n                max(collector_tstamp) as end_tstamp\n\n            from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_events_stg e\n\n            where\n                dvce_sent_tstamp <= \n\n    dateadd(\n        day,\n        3,\n        dvce_created_tstamp\n        )\n\n -- don't process data that's too late\n                and collector_tstamp >= \n        cast('2021-03-07 00:00:00' as timestamp)\n    \n                and collector_tstamp <= \n        cast('2021-11-05 00:00:00' as timestamp)\n    \n                and true\n                and cast(True as boolean) --don't reprocess sessions that have already been processed.\n                \n\n            group by 1\n        ), new_events_session_ids as (\n            select *\n            from new_events_session_ids_init e\n            \n\n        )\n        \n\n        , previous_sessions as (\n        select *\n\n        from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_base_sessions_lifecycle_manifest\n\n        where start_tstamp >= \n        cast('2019-03-08 00:00:00' as timestamp)\n    \n        and cast(True as boolean) --don't reprocess sessions that have already been processed.\n        )\n\n        , session_lifecycle as (\n        select\n            ns.session_identifier,\n            coalesce(self.user_identifier, ns.user_identifier) as user_identifier, -- Edge case 1: Take previous value to keep domain_userid consistent. Not deterministic but performant\n            least(ns.start_tstamp, coalesce(self.start_tstamp, ns.start_tstamp)) as start_tstamp,\n            greatest(ns.end_tstamp, coalesce(self.end_tstamp, ns.end_tstamp)) as end_tstamp -- BQ 1 NULL will return null hence coalesce\n\n        from new_events_session_ids ns\n        left join previous_sessions as self\n            on ns.session_identifier = self.session_identifier\n\n        where\n            self.session_identifier is null -- process all new sessions\n            or self.end_tstamp < \n\n    dateadd(\n        day,\n        3,\n        self.start_tstamp\n        )\n\n --stop updating sessions exceeding 3 days\n        )\n\n        \n\n        select\n        sl.session_identifier,\n        sl.user_identifier,\n        sl.start_tstamp,\n        least(\n\n    dateadd(\n        day,\n        3,\n        sl.start_tstamp\n        )\n\n, sl.end_tstamp) as end_tstamp -- limit session length to max_session_days\n        \n\n        from session_lifecycle sl\n    \n\nwhere session_identifier is not null", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_base_sessions_lifecycle_manifest"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:01.386376Z", "completed_at": "2024-05-14T15:34:01.405890Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:01.408559Z", "completed_at": "2024-05-14T15:34:01.408574Z"}], "thread_id": "Thread-2", "execution_time": 0.03387713432312012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_sessions_lifecycle_manifest_end_tstamp.b6c8cdd939", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_base_sessions_lifecycle_manifest\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:01.392808Z", "completed_at": "2024-05-14T15:34:01.407862Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:01.410025Z", "completed_at": "2024-05-14T15:34:01.410035Z"}], "thread_id": "Thread-3", "execution_time": 0.033327341079711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_sessions_lifecycle_manifest_session_identifier.af938216bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_base_sessions_lifecycle_manifest\nwhere session_identifier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:01.397949Z", "completed_at": "2024-05-14T15:34:01.410922Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:01.413123Z", "completed_at": "2024-05-14T15:34:01.413132Z"}], "thread_id": "Thread-4", "execution_time": 0.03513836860656738, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_sessions_lifecycle_manifest_start_tstamp.b4ba4713ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_base_sessions_lifecycle_manifest\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:01.421868Z", "completed_at": "2024-05-14T15:34:01.427142Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:01.427778Z", "completed_at": "2024-05-14T15:34:01.427792Z"}], "thread_id": "Thread-3", "execution_time": 0.013151168823242188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_base_sessions_lifecycle_manifest_session_identifier.6ce2812347", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_base_sessions_lifecycle_manifest\nwhere session_identifier is not null\ngroup by session_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:01.416734Z", "completed_at": "2024-05-14T15:34:01.428822Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:01.429457Z", "completed_at": "2024-05-14T15:34:01.429464Z"}], "thread_id": "Thread-2", "execution_time": 0.015470743179321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_sessions_lifecycle_manifest_user_identifier.34567389b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_base_sessions_lifecycle_manifest\nwhere user_identifier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:01.378782Z", "completed_at": "2024-05-14T15:34:02.032133Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:02.032779Z", "completed_at": "2024-05-14T15:34:02.032792Z"}], "thread_id": "Thread-1", "execution_time": 0.8952133655548096, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_base_sessions_this_run", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n        select\n        s.session_identifier,\n        s.user_identifier,\n        s.start_tstamp,\n        -- end_tstamp used in next step to limit events. When backfilling, set end_tstamp to upper_limit if end_tstamp > upper_limit.\n        -- This ensures we don't accidentally process events after upper_limit\n        case when s.end_tstamp > \n        cast('2021-11-05 00:00:00' as timestamp)\n     then \n        cast('2021-11-05 00:00:00' as timestamp)\n     else s.end_tstamp end as end_tstamp\n\n        from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snowplow_manifest.snowplow_mobile_base_sessions_lifecycle_manifest s\n\n        where\n        -- General window of start_tstamps to limit table scans. Logic complicated by backfills.\n        -- To be within the run, session start_tstamp must be >= lower_limit - max_session_days as we limit end_tstamp in manifest to start_tstamp + max_session_days\n        s.start_tstamp >= \n        cast('2021-03-04 00:00:00' as timestamp)\n    \n        and s.start_tstamp <= \n        cast('2021-11-05 00:00:00' as timestamp)\n    \n        -- Select sessions within window that either; start or finish between lower & upper limit, start and finish outside of lower and upper limits\n        and not (s.start_tstamp > \n        cast('2021-11-05 00:00:00' as timestamp)\n     or s.end_tstamp < \n        cast('2021-03-07 00:00:00' as timestamp)\n    )\n    ", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_sessions_this_run"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:02.302264Z", "completed_at": "2024-05-14T15:34:02.313438Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:02.314101Z", "completed_at": "2024-05-14T15:34:02.314115Z"}], "thread_id": "Thread-2", "execution_time": 0.03311514854431152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_sessions_this_run_session_identifier.c922ac5345", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_sessions_this_run\nwhere session_identifier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:02.295588Z", "completed_at": "2024-05-14T15:34:02.321856Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:02.322644Z", "completed_at": "2024-05-14T15:34:02.322653Z"}], "thread_id": "Thread-3", "execution_time": 0.048775672912597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_sessions_this_run_end_tstamp.5b40d15f17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_sessions_this_run\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:02.317203Z", "completed_at": "2024-05-14T15:34:02.326929Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:02.333743Z", "completed_at": "2024-05-14T15:34:02.333755Z"}], "thread_id": "Thread-2", "execution_time": 0.018163204193115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_sessions_this_run_user_identifier.14dd0f716e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_sessions_this_run\nwhere user_identifier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:02.307832Z", "completed_at": "2024-05-14T15:34:02.332910Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:02.334834Z", "completed_at": "2024-05-14T15:34:02.334843Z"}], "thread_id": "Thread-1", "execution_time": 0.041321516036987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_sessions_this_run_start_tstamp.9fa5bfa402", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_sessions_this_run\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:02.327866Z", "completed_at": "2024-05-14T15:34:02.336010Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:02.336621Z", "completed_at": "2024-05-14T15:34:02.336628Z"}], "thread_id": "Thread-3", "execution_time": 0.012470006942749023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_base_sessions_this_run_session_identifier.645afca11b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_sessions_this_run\nwhere session_identifier is not null\ngroup by session_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:02.275321Z", "completed_at": "2024-05-14T15:34:02.935982Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:02.936606Z", "completed_at": "2024-05-14T15:34:02.936619Z"}], "thread_id": "Thread-4", "execution_time": 0.8767688274383545, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_base_events_this_run", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith base_query as (\n  \n        with identified_events AS (\n            select\n                COALESCE(\n                        \ne.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:sessionId::TEXT\n,NULL\n                    ) as session_identifier,\n                e.*\n                \n\n            from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_events_stg e\n\n        )\n\n        select\n            a.*,\n            b.user_identifier -- take user_identifier from manifest. This ensures only 1 domain_userid per session.\n\n        from identified_events as a\n        inner join SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_sessions_this_run as b\n        on a.session_identifier = b.session_identifier\n\n        where a.collector_tstamp <= \n\n    dateadd(\n        day,\n        3,\n        b.start_tstamp\n        )\n\n\n        and a.dvce_sent_tstamp <= \n\n    dateadd(\n        day,\n        3,\n        a.dvce_created_tstamp\n        )\n\n\n        and a.collector_tstamp >= \n        cast('2021-03-07 22:46:41.963000' as timestamp)\n    \n        and a.collector_tstamp <= \n        cast('2021-04-21 13:50:44.234000' as timestamp)\n    \n        and a.collector_tstamp >= b.start_tstamp -- deal with late loading events\n\n        \n\n        and true\n\n        qualify row_number() over (partition by a.event_id order by a.collector_tstamp, a.dvce_created_tstamp) = 1\n    \n), final as (\n  select\n    -- screen view events\n    a.unstruct_event_com_snowplowanalytics_mobile_screen_view_1:id::varchar(36) AS screen_view_id,\n    a.unstruct_event_com_snowplowanalytics_mobile_screen_view_1:name::varchar AS screen_view_name,\n    a.unstruct_event_com_snowplowanalytics_mobile_screen_view_1:previousId::varchar(36) AS screen_view_previous_id,\n    a.unstruct_event_com_snowplowanalytics_mobile_screen_view_1:previousName::varchar AS screen_view_previous_name,\n    a.unstruct_event_com_snowplowanalytics_mobile_screen_view_1:previousType::varchar AS screen_view_previous_type,\n    a.unstruct_event_com_snowplowanalytics_mobile_screen_view_1:transitionType::varchar AS screen_view_transition_type,\n    a.unstruct_event_com_snowplowanalytics_mobile_screen_view_1:type::varchar AS screen_view_type,\n    -- screen context\n    \n      cast(null as TEXT) as screen_id, --could rename to screen_view_id and coalesce with screen view events.\n      cast(null as TEXT) as screen_name,\n      cast(null as TEXT) as screen_activity,\n      cast(null as TEXT) as screen_fragment,\n      cast(null as TEXT) as screen_top_view_controller,\n      cast(null as TEXT) as screen_type,\n      cast(null as TEXT) as screen_view_controller,\n    \n    -- mobile context\n    \n      cast(null as TEXT) as device_manufacturer,\n      cast(null as TEXT) as device_model,\n      cast(null as TEXT) as os_type,\n      cast(null as TEXT) as os_version,\n      cast(null as TEXT) as android_idfa,\n      cast(null as TEXT) as apple_idfa,\n      cast(null as TEXT) as apple_idfv,\n      cast(null as TEXT) as carrier,\n      cast(null as TEXT) as open_idfa,\n      cast(null as TEXT) as network_technology,\n      cast(null as TEXT) as network_type,\n    \n    -- geo context\n    \n      a.contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:latitude::float AS device_latitude,\n      a.contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:longitude::float AS device_longitude,\n      a.contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:latitudeLongitudeAccuracy::float AS device_latitude_longitude_accuracy,\n      a.contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:altitude::float AS device_altitude,\n      a.contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:altitudeAccuracy::float AS device_altitude_accuracy,\n      a.contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:bearing::float AS device_bearing,\n      a.contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:speed::float AS device_speed,\n    \n    -- app context\n    \n      cast(null as TEXT) as build,\n      cast(null as TEXT) as version,\n    \n    -- session context\n    a.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:sessionId::varchar(36) AS session_id,\n    a.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:sessionIndex::int AS session_index,\n    a.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:previousSessionId::varchar(36) AS previous_session_id,\n    a.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:userId::varchar(36) AS device_user_id,\n    a.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:firstEventId::varchar(36) AS session_first_event_id,\n    a.*\n\n  from base_query a\n)\n\nselect\n  a.session_identifier as session_id,\n  a.session_id as original_session_id,\n  a.user_identifier as device_user_id,\n  a.device_user_id as original_device_user_id,\n  a.* exclude(unstruct_event_com_snowplowanalytics_mobile_screen_view_1, session_id, device_user_id),\n\n  row_number() over(partition by session_identifier order by derived_tstamp) as event_index_in_session\n\nfrom final a", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.156803Z", "completed_at": "2024-05-14T15:34:03.190318Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.192318Z", "completed_at": "2024-05-14T15:34:03.192330Z"}], "thread_id": "Thread-2", "execution_time": 0.0409698486328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_screen_views_this_run", "compiled": true, "compiled_code": "\n\n\n\nwith screen_views_dedupe as (\n  select\n    ev.screen_view_id,\n    ev.event_id,\n\n    ev.app_id,\n\n    ev.user_id,\n    ev.original_device_user_id,\n    ev.user_identifier,\n    ev.device_user_id,\n    ev.network_userid,\n\n    ev.session_id,\n    ev.session_identifier,\n    ev.original_session_id,\n    ev.session_index,\n    ev.previous_session_id,\n    ev.session_first_event_id,\n\n    ev.dvce_created_tstamp,\n    ev.collector_tstamp,\n    ev.derived_tstamp,\n\n    ev.screen_view_name,\n    ev.screen_view_transition_type,\n    ev.screen_view_type,\n    ev.screen_fragment,\n    ev.screen_top_view_controller,\n    ev.screen_view_controller,\n    ev.screen_view_previous_id,\n    ev.screen_view_previous_name,\n    ev.screen_view_previous_type,\n\n    ev.platform,\n    ev.dvce_screenwidth,\n    ev.dvce_screenheight,\n    ev.device_manufacturer,\n    ev.device_model,\n    ev.os_type,\n    ev.os_version,\n    ev.android_idfa,\n    ev.apple_idfa,\n    ev.apple_idfv,\n    ev.carrier,\n    ev.open_idfa,\n    ev.network_technology,\n    ev.network_type,\n\n    ev.device_latitude,\n    ev.device_longitude,\n    ev.device_latitude_longitude_accuracy,\n    ev.device_altitude,\n    ev.device_altitude_accuracy,\n    ev.device_bearing,\n    ev.device_speed,\n    ev.geo_country,\n    ev.geo_region,\n    ev.geo_city,\n    ev.geo_zipcode,\n    ev.geo_latitude,\n    ev.geo_longitude,\n    ev.geo_region_name,\n    ev.geo_timezone,\n\n    ev.user_ipaddress,\n\n    ev.useragent,\n\n    ev.build,\n    ev.version,\n\n    row_number() over (partition by ev.screen_view_id order by ev.derived_tstamp) as screen_view_id_index\n      ,ev.v_collector\n      ,event_id as event_id2\n\n  from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run as ev\n\n  where ev.event_name = 'screen_view'\n  and ev.screen_view_id is not null\n)\n\n, cleaned_screen_view_events AS (\n  select\n    *,\n    row_number() over (partition by sv.session_id order by sv.derived_tstamp) as screen_view_in_session_index\n\n  from screen_views_dedupe sv\n\n  where sv.screen_view_id_index = 1 --take first row of duplicates\n  )\n\nselect\n  ev.screen_view_id,\n  ev.event_id,\n\n  ev.app_id,\n\n  ev.user_id,\n  ev.user_identifier,\n  ev.device_user_id,\n  ev.network_userid,\n\n  ev.session_id,\n  ev.original_session_id,\n  ev.session_identifier,\n  ev.session_index,\n  ev.previous_session_id,\n  ev.session_first_event_id,\n\n  ev.screen_view_in_session_index,\n  max(ev.screen_view_in_session_index) over (partition by ev.session_id) as screen_views_in_session,\n\n  ev.dvce_created_tstamp,\n  ev.collector_tstamp,\n  ev.derived_tstamp,\n  \n    convert_timezone('UTC', convert_timezone('UTC', current_timestamp()))::timestamp\n AS model_tstamp,\n\n  ev.screen_view_name,\n  ev.screen_view_transition_type,\n  ev.screen_view_type,\n  ev.screen_fragment,\n  ev.screen_top_view_controller,\n  ev.screen_view_controller,\n  ev.screen_view_previous_id,\n  ev.screen_view_previous_name,\n  ev.screen_view_previous_type,\n\n  ev.platform,\n  ev.dvce_screenwidth,\n  ev.dvce_screenheight,\n  ev.device_manufacturer,\n  ev.device_model,\n  ev.os_type,\n  ev.os_version,\n  ev.android_idfa,\n  ev.apple_idfa,\n  ev.apple_idfv,\n  ev.open_idfa,\n  ev.carrier,\n  ev.network_technology,\n  ev.network_type,\n\n  ev.device_latitude,\n  ev.device_longitude,\n  ev.device_latitude_longitude_accuracy,\n  ev.device_altitude,\n  ev.device_altitude_accuracy,\n  ev.device_bearing,\n  ev.device_speed,\n  ev.geo_country,\n  ev.geo_region,\n  ev.geo_city,\n  ev.geo_zipcode,\n  ev.geo_latitude,\n  ev.geo_longitude,\n  ev.geo_region_name,\n  ev.geo_timezone,\n\n  ev.user_ipaddress,\n\n  ev.useragent,\n  ev.build,\n  ev.version\n      , ev.v_collector\n      , ev.event_id2\n\nfrom cleaned_screen_view_events ev", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.167600Z", "completed_at": "2024-05-14T15:34:03.191629Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.193998Z", "completed_at": "2024-05-14T15:34:03.194006Z"}], "thread_id": "Thread-1", "execution_time": 0.041277408599853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_sessions_aggs", "compiled": true, "compiled_code": "\n\n\n\nwith events as (\n  select\n    es.session_id,\n    es.event_id,\n    es.event_name,\n    es.derived_tstamp,\n    es.build,\n    es.version,\n    es.event_index_in_session,\n    MAX(es.event_index_in_session) over (partition by es.session_id) as events_in_session\n\n  from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run   es\n)\n\n, session_aggs AS (\n  select\n    e.session_id,\n    --last dimensions\n    MAX(case when e.event_index_in_session = e.events_in_session then e.build end) as last_build,\n    MAX(case when e.event_index_in_session = e.events_in_session then e.version end) as last_version,\n    MAX(case when e.event_index_in_session = e.events_in_session then e.event_name end) as last_event_name,\n    \n      MAX(case when e.event_index_in_session = e.events_in_session then e.event_id end) as session_last_event_id,\n    \n\n    -- time\n    MIN(e.derived_tstamp) as start_tstamp,\n    MAX(e.derived_tstamp) as end_tstamp,\n    \n\n  BOOLOR_AGG(\n    e.event_name = 'application_install'\n  )\n\n as has_install\n\n  from events e\n\n  group by 1\n)\n\n, app_errors as (\n  \n    select\n      cast(null as TEXT) as session_id,\n      cast(null as integer) as app_errors,\n      cast(null as integer) as fatal_app_errors\n  \n)\n\n\nselect\n  sa.session_id,\n  sa.last_build,\n  sa.last_version,\n  sa.last_event_name,\n  sa.session_last_event_id,\n  sa.start_tstamp,\n  sa.end_tstamp,\n  datediff(\n        second,\n        sa.start_tstamp,\n        sa.end_tstamp\n        ) as session_duration_s,\n  sa.has_install,\n  ae.app_errors,\n  ae.fatal_app_errors\n\nfrom session_aggs sa\nleft join app_errors ae\non sa.session_id = ae.session_id", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.182621Z", "completed_at": "2024-05-14T15:34:03.194923Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.198285Z", "completed_at": "2024-05-14T15:34:03.198294Z"}], "thread_id": "Thread-4", "execution_time": 0.04240727424621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.snowplow_mobile.snowplow_mobile-on-run-end-0", "compiled": true, "compiled_code": "\n\n  \n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.210164Z", "completed_at": "2024-05-14T15:34:03.220503Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.222156Z", "completed_at": "2024-05-14T15:34:03.222165Z"}], "thread_id": "Thread-1", "execution_time": 0.02036261558532715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_derived_tstamp.55b6ffc77f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect derived_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere derived_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.205486Z", "completed_at": "2024-05-14T15:34:03.221326Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.223306Z", "completed_at": "2024-05-14T15:34:03.223314Z"}], "thread_id": "Thread-2", "execution_time": 0.02275824546813965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_collector_tstamp.a1172840f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collector_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere collector_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.215717Z", "completed_at": "2024-05-14T15:34:03.224262Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.226381Z", "completed_at": "2024-05-14T15:34:03.226389Z"}], "thread_id": "Thread-4", "execution_time": 0.021717071533203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_device_user_id.7d111972a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.231424Z", "completed_at": "2024-05-14T15:34:03.242885Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.248522Z", "completed_at": "2024-05-14T15:34:03.248534Z"}], "thread_id": "Thread-1", "execution_time": 0.021365642547607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_dvce_created_tstamp.4bdf3d4649", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dvce_created_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere dvce_created_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.236199Z", "completed_at": "2024-05-14T15:34:03.247882Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.249646Z", "completed_at": "2024-05-14T15:34:03.249654Z"}], "thread_id": "Thread-2", "execution_time": 0.02181267738342285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_dvce_sent_tstamp.b8e0436897", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dvce_sent_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere dvce_sent_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.243522Z", "completed_at": "2024-05-14T15:34:03.251255Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.253346Z", "completed_at": "2024-05-14T15:34:03.253354Z"}], "thread_id": "Thread-4", "execution_time": 0.022794246673583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_etl_tstamp.c00e099318", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect etl_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere etl_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.256894Z", "completed_at": "2024-05-14T15:34:03.273860Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.274526Z", "completed_at": "2024-05-14T15:34:03.274534Z"}], "thread_id": "Thread-1", "execution_time": 0.022003173828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_event_id.b4133d222d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.267620Z", "completed_at": "2024-05-14T15:34:03.276889Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.278165Z", "completed_at": "2024-05-14T15:34:03.278172Z"}], "thread_id": "Thread-4", "execution_time": 0.01674365997314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_session_first_event_id.486e478e3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_first_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere session_first_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.262223Z", "completed_at": "2024-05-14T15:34:03.283518Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.285093Z", "completed_at": "2024-05-14T15:34:03.285102Z"}], "thread_id": "Thread-2", "execution_time": 0.030933618545532227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_network_userid.b73811b80e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere network_userid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.279094Z", "completed_at": "2024-05-14T15:34:03.286076Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.288042Z", "completed_at": "2024-05-14T15:34:03.288051Z"}], "thread_id": "Thread-1", "execution_time": 0.011977672576904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_session_id.f7961d52ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.291349Z", "completed_at": "2024-05-14T15:34:03.303526Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.310127Z", "completed_at": "2024-05-14T15:34:03.310137Z"}], "thread_id": "Thread-4", "execution_time": 0.023578882217407227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_base_events_this_run_session_index.3380037ea0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_index\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere session_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.297977Z", "completed_at": "2024-05-14T15:34:03.309388Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.314509Z", "completed_at": "2024-05-14T15:34:03.314519Z"}], "thread_id": "Thread-2", "execution_time": 0.02485799789428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_base_events_this_run_event_id.159562de46", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.323085Z", "completed_at": "2024-05-14T15:34:03.334210Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.334884Z", "completed_at": "2024-05-14T15:34:03.334893Z"}], "thread_id": "Thread-4", "execution_time": 0.017169475555419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_sessions_sv_details", "compiled": true, "compiled_code": "\n\n\n\nselect\n  sv.session_id,\n  COUNT(distinct sv.screen_view_id) as screen_views,\n  COUNT(distinct sv.screen_view_name) as screen_names_viewed,\n  --Could split below into first/last scratch tables. Trying to minimise joins to sessions.\n  MAX(case when sv.screen_view_in_session_index = 1 then sv.screen_view_name end) as first_screen_view_name,\n  MAX(case when sv.screen_view_in_session_index = 1 then sv.screen_view_transition_type end) as first_screen_view_transition_type,\n  MAX(case when sv.screen_view_in_session_index = 1 then sv.screen_view_type end) as first_screen_view_type,\n  MAX(case when sv.screen_view_in_session_index = sv.screen_views_in_session then sv.screen_view_name end) as last_screen_view_name,\n  MAX(case when sv.screen_view_in_session_index = sv.screen_views_in_session then sv.screen_view_transition_type end) as last_screen_view_transition_type,\n  MAX(case when sv.screen_view_in_session_index = sv.screen_views_in_session then sv.screen_view_type end) as last_screen_view_type\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run sv\n\ngroup by 1", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_sv_details"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.329339Z", "completed_at": "2024-05-14T15:34:03.336599Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.338031Z", "completed_at": "2024-05-14T15:34:03.338040Z"}], "thread_id": "Thread-2", "execution_time": 0.01904463768005371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_collector_tstamp.7bd4f2c23e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collector_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere collector_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.346189Z", "completed_at": "2024-05-14T15:34:03.351046Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.352270Z", "completed_at": "2024-05-14T15:34:03.352280Z"}], "thread_id": "Thread-2", "execution_time": 0.007626533508300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_device_user_id.bfee38b947", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.340228Z", "completed_at": "2024-05-14T15:34:03.351672Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.353230Z", "completed_at": "2024-05-14T15:34:03.353240Z"}], "thread_id": "Thread-4", "execution_time": 0.015996694564819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_derived_tstamp.7a4b0529a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect derived_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere derived_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.358184Z", "completed_at": "2024-05-14T15:34:03.368800Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.370070Z", "completed_at": "2024-05-14T15:34:03.370079Z"}], "thread_id": "Thread-2", "execution_time": 0.01454305648803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_dvce_created_tstamp.1f098f64b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dvce_created_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere dvce_created_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.363004Z", "completed_at": "2024-05-14T15:34:03.369469Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.371068Z", "completed_at": "2024-05-14T15:34:03.371078Z"}], "thread_id": "Thread-4", "execution_time": 0.014874696731567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_event_id.10de4affeb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.375947Z", "completed_at": "2024-05-14T15:34:03.385351Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.386591Z", "completed_at": "2024-05-14T15:34:03.386600Z"}], "thread_id": "Thread-2", "execution_time": 0.013282537460327148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_model_tstamp.4a47e15195", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere model_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.380459Z", "completed_at": "2024-05-14T15:34:03.385995Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.387517Z", "completed_at": "2024-05-14T15:34:03.387526Z"}], "thread_id": "Thread-4", "execution_time": 0.013536691665649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_network_userid.bfdb9af1e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere network_userid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.392436Z", "completed_at": "2024-05-14T15:34:03.402996Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.403679Z", "completed_at": "2024-05-14T15:34:03.403688Z"}], "thread_id": "Thread-2", "execution_time": 0.013936281204223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_screen_view_id.7fb0685deb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect screen_view_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere screen_view_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.396961Z", "completed_at": "2024-05-14T15:34:03.411496Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.412166Z", "completed_at": "2024-05-14T15:34:03.412177Z"}], "thread_id": "Thread-4", "execution_time": 0.021732330322265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_screen_view_in_session_index.ec50ffbb39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect screen_view_in_session_index\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere screen_view_in_session_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.406632Z", "completed_at": "2024-05-14T15:34:03.413118Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.414407Z", "completed_at": "2024-05-14T15:34:03.414416Z"}], "thread_id": "Thread-2", "execution_time": 0.009125709533691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_screen_views_in_session.fef854ec29", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect screen_views_in_session\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere screen_views_in_session is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.418045Z", "completed_at": "2024-05-14T15:34:03.428224Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.428857Z", "completed_at": "2024-05-14T15:34:03.428865Z"}], "thread_id": "Thread-4", "execution_time": 0.01363992691040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_session_first_event_id.f129d48f00", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_first_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere session_first_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.423608Z", "completed_at": "2024-05-14T15:34:03.431218Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.432431Z", "completed_at": "2024-05-14T15:34:03.432440Z"}], "thread_id": "Thread-2", "execution_time": 0.01516103744506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_session_id.4abc08fbeb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.433368Z", "completed_at": "2024-05-14T15:34:03.445528Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.446566Z", "completed_at": "2024-05-14T15:34:03.446576Z"}], "thread_id": "Thread-4", "execution_time": 0.016169071197509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_this_run_session_index.a29a0a20b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_index\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere session_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.440348Z", "completed_at": "2024-05-14T15:34:03.454221Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.455305Z", "completed_at": "2024-05-14T15:34:03.455317Z"}], "thread_id": "Thread-2", "execution_time": 0.016401290893554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_screen_views_this_run_event_id.4a3bdc7441", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.449726Z", "completed_at": "2024-05-14T15:34:03.458347Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.463459Z", "completed_at": "2024-05-14T15:34:03.463469Z"}], "thread_id": "Thread-4", "execution_time": 0.015188217163085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_screen_views_this_run_screen_view_id.1fc81802de", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    screen_view_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere screen_view_id is not null\ngroup by screen_view_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.458940Z", "completed_at": "2024-05-14T15:34:03.471310Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.471943Z", "completed_at": "2024-05-14T15:34:03.471951Z"}], "thread_id": "Thread-2", "execution_time": 0.015135526657104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_aggs_end_tstamp.f56eef6f20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.466670Z", "completed_at": "2024-05-14T15:34:03.479473Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.480181Z", "completed_at": "2024-05-14T15:34:03.480189Z"}], "thread_id": "Thread-4", "execution_time": 0.014881372451782227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_aggs_has_install.9f2f470a86", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect has_install\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs\nwhere has_install is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.475023Z", "completed_at": "2024-05-14T15:34:03.488705Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.489548Z", "completed_at": "2024-05-14T15:34:03.489556Z"}], "thread_id": "Thread-2", "execution_time": 0.01599431037902832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_aggs_last_event_name.500689c11b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_event_name\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs\nwhere last_event_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.483064Z", "completed_at": "2024-05-14T15:34:03.492747Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.506189Z", "completed_at": "2024-05-14T15:34:03.506199Z"}], "thread_id": "Thread-4", "execution_time": 0.024521350860595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_aggs_session_duration_s.6ca4bcb93f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_duration_s\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs\nwhere session_duration_s is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.493793Z", "completed_at": "2024-05-14T15:34:03.512114Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.513497Z", "completed_at": "2024-05-14T15:34:03.513508Z"}], "thread_id": "Thread-2", "execution_time": 0.022460222244262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_aggs_session_id.47b3434bdf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.514434Z", "completed_at": "2024-05-14T15:34:03.525874Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.526590Z", "completed_at": "2024-05-14T15:34:03.526602Z"}], "thread_id": "Thread-4", "execution_time": 0.015311479568481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_aggs_session_last_event_id.ddc5902f34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_last_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs\nwhere session_last_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.521268Z", "completed_at": "2024-05-14T15:34:03.528918Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.530140Z", "completed_at": "2024-05-14T15:34:03.530149Z"}], "thread_id": "Thread-2", "execution_time": 0.01042032241821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_aggs_start_tstamp.c6b04e0159", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.531045Z", "completed_at": "2024-05-14T15:34:03.548539Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.549213Z", "completed_at": "2024-05-14T15:34:03.549221Z"}], "thread_id": "Thread-4", "execution_time": 0.02106189727783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_sessions_aggs_session_id.f8299034b2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs\nwhere session_id is not null\ngroup by session_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.538532Z", "completed_at": "2024-05-14T15:34:03.552384Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.557664Z", "completed_at": "2024-05-14T15:34:03.557673Z"}], "thread_id": "Thread-2", "execution_time": 0.020512104034423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_sessions_this_run", "compiled": true, "compiled_code": "\n\n\n\nselect\n  -- app id\n  es.app_id,\n\n  -- session fields\n  es.session_identifier,\n  es.original_session_id,\n  es.session_id,\n  es.session_index,\n  es.previous_session_id,\n  es.session_first_event_id,\n  sa.session_last_event_id,\n\n  sa.start_tstamp,\n  sa.end_tstamp,\n  \n    convert_timezone('UTC', convert_timezone('UTC', current_timestamp()))::timestamp\n as model_tstamp,\n\n  -- user fields\n  es.user_id,\n  es.original_device_user_id,\n  es.device_user_id,\n  es.user_identifier,\n  es.network_userid,\n\n  \n    -- updated with mapping as part of post hook on derived sessions table\n    cast(es.device_user_id as \n    TEXT\n) as stitched_user_id,\n  \n\n  sa.session_duration_s,\n  sa.has_install,\n  sv.screen_views,\n  sv.screen_names_viewed,\n  cast(sa.app_errors as integer) as app_errors,\n  cast(sa.fatal_app_errors as integer) as fatal_app_errors,\n\n  es.event_name as first_event_name,\n  sa.last_event_name,\n\n  sv.first_screen_view_name,\n  sv.first_screen_view_transition_type,\n  sv.first_screen_view_type,\n\n  sv.last_screen_view_name,\n  sv.last_screen_view_transition_type,\n  sv.last_screen_view_type,\n\n  es.platform,\n  es.dvce_screenwidth,\n  es.dvce_screenheight,\n  es.device_manufacturer,\n  es.device_model,\n  es.os_type,\n  es.os_version,\n  es.android_idfa,\n  es.apple_idfa,\n  es.apple_idfv,\n  es.open_idfa,\n  es.carrier,\n  es.network_technology,\n  es.network_type,\n  es.device_latitude,\n  es.device_longitude,\n  es.device_latitude_longitude_accuracy,\n  es.device_altitude,\n  es.device_altitude_accuracy,\n  es.device_bearing,\n  es.device_speed,\n  es.geo_country,\n  es.geo_region,\n  es.geo_city,\n  es.geo_zipcode,\n  es.geo_latitude,\n  es.geo_longitude,\n  es.geo_region_name,\n  es.geo_timezone,\n\n  es.user_ipaddress,\n\n  es.useragent,\n  es.name_tracker,\n  es.v_tracker,\n\n  --first/last build/version to measure app updates.\n  es.build as first_build,\n  sa.last_build,\n  es.version as first_version,\n  sa.last_version\n      ,es.event_id\n      ,event_id as event_id2\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run as es\n\ninner join SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_aggs as sa\non es.session_id = sa.session_id\nand es.event_index_in_session = 1\n\nleft join SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_sv_details sv\non es.session_id = sv.session_id", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.560692Z", "completed_at": "2024-05-14T15:34:03.565842Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.567086Z", "completed_at": "2024-05-14T15:34:03.567095Z"}], "thread_id": "Thread-2", "execution_time": 0.007748603820800781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_sessions_sv_details_session_id.6e4fde92c9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_sv_details\nwhere session_id is not null\ngroup by session_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.553014Z", "completed_at": "2024-05-14T15:34:03.566484Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.568026Z", "completed_at": "2024-05-14T15:34:03.568036Z"}], "thread_id": "Thread-4", "execution_time": 0.017263174057006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_sv_details_session_id.0475dc092c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_sv_details\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.572904Z", "completed_at": "2024-05-14T15:34:03.583461Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.584712Z", "completed_at": "2024-05-14T15:34:03.584722Z"}], "thread_id": "Thread-2", "execution_time": 0.014464378356933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_device_user_id.818a6a9597", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.577606Z", "completed_at": "2024-05-14T15:34:03.584110Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.585697Z", "completed_at": "2024-05-14T15:34:03.585706Z"}], "thread_id": "Thread-4", "execution_time": 0.014771223068237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_end_tstamp.d2e71cb30c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.590607Z", "completed_at": "2024-05-14T15:34:03.599912Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.601193Z", "completed_at": "2024-05-14T15:34:03.601204Z"}], "thread_id": "Thread-2", "execution_time": 0.013300895690917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_has_install.5b082c4665", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect has_install\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere has_install is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.595161Z", "completed_at": "2024-05-14T15:34:03.600557Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.602132Z", "completed_at": "2024-05-14T15:34:03.602142Z"}], "thread_id": "Thread-4", "execution_time": 0.013530969619750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_last_event_name.f17f4c9837", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_event_name\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere last_event_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.607079Z", "completed_at": "2024-05-14T15:34:03.616785Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.618052Z", "completed_at": "2024-05-14T15:34:03.618063Z"}], "thread_id": "Thread-2", "execution_time": 0.013714313507080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_model_tstamp.7fbc271a9c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere model_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.611782Z", "completed_at": "2024-05-14T15:34:03.617458Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.618993Z", "completed_at": "2024-05-14T15:34:03.619002Z"}], "thread_id": "Thread-4", "execution_time": 0.013927698135375977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_network_userid.118e602579", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere network_userid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.623953Z", "completed_at": "2024-05-14T15:34:03.634997Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.635649Z", "completed_at": "2024-05-14T15:34:03.635663Z"}], "thread_id": "Thread-2", "execution_time": 0.014369010925292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_session_duration_s.6a784b2f14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_duration_s\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere session_duration_s is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.630055Z", "completed_at": "2024-05-14T15:34:03.636594Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.637956Z", "completed_at": "2024-05-14T15:34:03.637964Z"}], "thread_id": "Thread-4", "execution_time": 0.015993118286132812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_session_first_event_id.3d53e20ca1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_first_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere session_first_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.647036Z", "completed_at": "2024-05-14T15:34:03.663418Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.664152Z", "completed_at": "2024-05-14T15:34:03.664166Z"}], "thread_id": "Thread-4", "execution_time": 0.02344655990600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_session_index.389742373c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_index\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere session_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.641536Z", "completed_at": "2024-05-14T15:34:03.666731Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.667952Z", "completed_at": "2024-05-14T15:34:03.667962Z"}], "thread_id": "Thread-2", "execution_time": 0.029186487197875977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_session_id.51937c6131", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.668873Z", "completed_at": "2024-05-14T15:34:03.681919Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.683805Z", "completed_at": "2024-05-14T15:34:03.683814Z"}], "thread_id": "Thread-4", "execution_time": 0.01802802085876465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_session_last_event_id.cbcf730b7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_last_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere session_last_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.676864Z", "completed_at": "2024-05-14T15:34:03.685611Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.688395Z", "completed_at": "2024-05-14T15:34:03.688404Z"}], "thread_id": "Thread-2", "execution_time": 0.012973785400390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_this_run_start_tstamp.edcf583857", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.690835Z", "completed_at": "2024-05-14T15:34:03.701516Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.702183Z", "completed_at": "2024-05-14T15:34:03.702195Z"}], "thread_id": "Thread-4", "execution_time": 0.016089677810668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_sessions_this_run_previous_session_id.5129432ea4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    previous_session_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere previous_session_id is not null\ngroup by previous_session_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.696962Z", "completed_at": "2024-05-14T15:34:03.704590Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.705836Z", "completed_at": "2024-05-14T15:34:03.705845Z"}], "thread_id": "Thread-2", "execution_time": 0.010408401489257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_sessions_this_run_session_first_event_id.602300de8c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_first_event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere session_first_event_id is not null\ngroup by session_first_event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.706737Z", "completed_at": "2024-05-14T15:34:03.718563Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.719533Z", "completed_at": "2024-05-14T15:34:03.719543Z"}], "thread_id": "Thread-4", "execution_time": 0.01576709747314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_sessions_this_run_session_id.c3ea918880", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere session_id is not null\ngroup by session_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.713490Z", "completed_at": "2024-05-14T15:34:03.720690Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:03.721320Z", "completed_at": "2024-05-14T15:34:03.721327Z"}], "thread_id": "Thread-2", "execution_time": 0.009372711181640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_sessions_this_run_session_last_event_id.c46459ce00", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_last_event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere session_last_event_id is not null\ngroup by session_last_event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.177191Z", "completed_at": "2024-05-14T15:34:04.394226Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.394881Z", "completed_at": "2024-05-14T15:34:04.394894Z"}], "thread_id": "Thread-3", "execution_time": 1.4593939781188965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_user_mapping", "compiled": true, "compiled_code": "\n\n\n\n\nselect distinct\n  device_user_id,\n  last_value(user_id) over(\n    partition by device_user_id\n    order by collector_tstamp\n    rows between unbounded preceding and unbounded following\n  ) as user_id,\n  max(collector_tstamp) over (partition by device_user_id) as end_tstamp\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_events_this_run\n\nwhere cast(True as boolean) --returns false if run doesn't contain new events.\nand user_id is not null\nand device_user_id is not null", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_user_mapping"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.631455Z", "completed_at": "2024-05-14T15:34:04.636382Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.637161Z", "completed_at": "2024-05-14T15:34:04.637171Z"}], "thread_id": "Thread-3", "execution_time": 0.017772912979125977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_user_mapping_user_id.05aee756eb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_user_mapping\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.626858Z", "completed_at": "2024-05-14T15:34:04.638758Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.640634Z", "completed_at": "2024-05-14T15:34:04.640642Z"}], "thread_id": "Thread-2", "execution_time": 0.022507667541503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_user_mapping_end_tstamp.47359d27bd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_user_mapping\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.620760Z", "completed_at": "2024-05-14T15:34:04.640020Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.642223Z", "completed_at": "2024-05-14T15:34:04.642232Z"}], "thread_id": "Thread-4", "execution_time": 0.025426149368286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_user_mapping_device_user_id.69bb4ae18e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_user_mapping\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.643816Z", "completed_at": "2024-05-14T15:34:04.659052Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.660427Z", "completed_at": "2024-05-14T15:34:04.660435Z"}], "thread_id": "Thread-3", "execution_time": 0.02114391326904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_user_mapping_device_user_id.c09448ab5c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_user_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_user_mapping\nwhere device_user_id is not null\ngroup by device_user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:03.304290Z", "completed_at": "2024-05-14T15:34:04.473374Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.474073Z", "completed_at": "2024-05-14T15:34:04.474083Z"}], "thread_id": "Thread-1", "execution_time": 1.384411096572876, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_screen_views", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n    \nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_screen_views_this_run\nwhere cast(True as boolean) --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.688357Z", "completed_at": "2024-05-14T15:34:04.701961Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.702697Z", "completed_at": "2024-05-14T15:34:04.702705Z"}], "thread_id": "Thread-4", "execution_time": 0.018257617950439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile_integration_tests.snowplow_mobile_screen_views_actual", "compiled": true, "compiled_code": "\n\n-- Removing model_tstamp\n\nselect\n  screen_view_id,\n  event_id,\n  app_id,\n  user_id,\n  device_user_id,\n  network_userid,\n  session_id,\n  session_index,\n  previous_session_id,\n  session_first_event_id,\n  screen_view_in_session_index,\n  screen_views_in_session,\n  dvce_created_tstamp,\n  collector_tstamp,\n  derived_tstamp,\n  model_tstamp,\n  screen_view_name,\n  screen_view_transition_type,\n  screen_view_type,\n  screen_fragment,\n  screen_top_view_controller,\n  screen_view_controller,\n  screen_view_previous_id,\n  screen_view_previous_name,\n  screen_view_previous_type,\n  platform,\n  dvce_screenwidth,\n  dvce_screenheight,\n  device_manufacturer,\n  device_model,\n  os_type,\n  os_version,\n  android_idfa,\n  apple_idfa,\n  apple_idfv,\n  open_idfa,\n  device_latitude,\n  device_longitude,\n  device_latitude_longitude_accuracy,\n  device_altitude,\n  device_altitude_accuracy,\n  device_bearing,\n  device_speed,\n  geo_country,\n  geo_region,\n  geo_city,\n  geo_zipcode,\n  geo_latitude,\n  geo_longitude,\n  geo_region_name,\n  geo_timezone,\n  user_ipaddress,\n  useragent,\n  carrier,\n  network_technology,\n  network_type,\n  build,\n  version\n\n  , event_id2\n  , v_collector\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_screen_views_actual"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.697106Z", "completed_at": "2024-05-14T15:34:04.704954Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.706963Z", "completed_at": "2024-05-14T15:34:04.706971Z"}], "thread_id": "Thread-1", "execution_time": 0.01994466781616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_derived_tstamp.3781474576", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect derived_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere derived_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.692568Z", "completed_at": "2024-05-14T15:34:04.706351Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.713353Z", "completed_at": "2024-05-14T15:34:04.713362Z"}], "thread_id": "Thread-3", "execution_time": 0.027598857879638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_collector_tstamp.1e58a9b981", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collector_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere collector_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.707866Z", "completed_at": "2024-05-14T15:34:04.715868Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.717798Z", "completed_at": "2024-05-14T15:34:04.717806Z"}], "thread_id": "Thread-4", "execution_time": 0.013595104217529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_device_user_id.486db3694d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.720588Z", "completed_at": "2024-05-14T15:34:04.735917Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.737273Z", "completed_at": "2024-05-14T15:34:04.737281Z"}], "thread_id": "Thread-1", "execution_time": 0.02093029022216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_dvce_created_tstamp.011ee49e3f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dvce_created_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere dvce_created_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.725197Z", "completed_at": "2024-05-14T15:34:04.736629Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.738776Z", "completed_at": "2024-05-14T15:34:04.738784Z"}], "thread_id": "Thread-3", "execution_time": 0.0217440128326416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_event_id.8f277f53a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.731124Z", "completed_at": "2024-05-14T15:34:04.738157Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.740392Z", "completed_at": "2024-05-14T15:34:04.740400Z"}], "thread_id": "Thread-4", "execution_time": 0.010846853256225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_model_tstamp.f93b02958e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere model_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.745924Z", "completed_at": "2024-05-14T15:34:04.826386Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.827839Z", "completed_at": "2024-05-14T15:34:04.827851Z"}], "thread_id": "Thread-1", "execution_time": 0.08594155311584473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_network_userid.935c512a94", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere network_userid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.751249Z", "completed_at": "2024-05-14T15:34:04.827191Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.829057Z", "completed_at": "2024-05-14T15:34:04.829066Z"}], "thread_id": "Thread-3", "execution_time": 0.08576202392578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_screen_view_id.a51c9e7878", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect screen_view_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere screen_view_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.821315Z", "completed_at": "2024-05-14T15:34:04.831923Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.834793Z", "completed_at": "2024-05-14T15:34:04.834802Z"}], "thread_id": "Thread-4", "execution_time": 0.09024262428283691, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_screen_view_in_session_index.7ff73a241f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect screen_view_in_session_index\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere screen_view_in_session_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.842718Z", "completed_at": "2024-05-14T15:34:04.853719Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.854483Z", "completed_at": "2024-05-14T15:34:04.854494Z"}], "thread_id": "Thread-3", "execution_time": 0.020910263061523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_session_first_event_id.ad0faf8b70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_first_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere session_first_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.849232Z", "completed_at": "2024-05-14T15:34:04.856963Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.858743Z", "completed_at": "2024-05-14T15:34:04.858750Z"}], "thread_id": "Thread-4", "execution_time": 0.011394739151000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_session_id.0ce5668518", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.838105Z", "completed_at": "2024-05-14T15:34:04.858142Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.865474Z", "completed_at": "2024-05-14T15:34:04.865483Z"}], "thread_id": "Thread-1", "execution_time": 0.032560110092163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_screen_views_in_session.e4d1199be7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect screen_views_in_session\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere screen_views_in_session is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.859647Z", "completed_at": "2024-05-14T15:34:04.868654Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.870572Z", "completed_at": "2024-05-14T15:34:04.870581Z"}], "thread_id": "Thread-3", "execution_time": 0.014458417892456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_screen_views_session_index.40bc3d08c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_index\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere session_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.876496Z", "completed_at": "2024-05-14T15:34:04.887227Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.888505Z", "completed_at": "2024-05-14T15:34:04.888513Z"}], "thread_id": "Thread-1", "execution_time": 0.01930856704711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_screen_views_event_id.6eb0883b2e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.872067Z", "completed_at": "2024-05-14T15:34:04.887890Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.890070Z", "completed_at": "2024-05-14T15:34:04.890078Z"}], "thread_id": "Thread-4", "execution_time": 0.02215576171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.snowplow_tests_screen_view_in_session_values", "compiled": true, "compiled_code": "\n\n\nwith prep as (\n  select \n    session_id, \n    count(distinct screen_views_in_session) as dist_svis_values,\n    count(*) - count(distinct screen_view_in_session_index)  as all_minus_dist_svisi,\n    count(*) - count(distinct screen_view_id) as all_minus_dist_svids \n\n  from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\n  group by 1\n)\n\nselect\n  session_id\n\nfrom prep\n\nwhere dist_svis_values != 1\nor all_minus_dist_svisi != 0\nor all_minus_dist_svids != 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.882595Z", "completed_at": "2024-05-14T15:34:04.889475Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.891719Z", "completed_at": "2024-05-14T15:34:04.891726Z"}], "thread_id": "Thread-3", "execution_time": 0.010685443878173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_screen_views_screen_view_id.4c469242da", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    screen_view_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_screen_views\nwhere screen_view_id is not null\ngroup by screen_view_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.896312Z", "completed_at": "2024-05-14T15:34:04.924039Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:04.925439Z", "completed_at": "2024-05-14T15:34:04.925449Z"}], "thread_id": "Thread-1", "execution_time": 0.03207683563232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile_integration_tests.dbt_utils_equal_rowcount_snowplow_mobile_screen_views_actual_ref_snowplow_mobile_screen_views_expected_stg_.5e602097eb", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_screen_views_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_screen_views_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.649943Z", "completed_at": "2024-05-14T15:34:05.416486Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.417127Z", "completed_at": "2024-05-14T15:34:05.417140Z"}], "thread_id": "Thread-2", "execution_time": 0.9881641864776611, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_sessions", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n  \nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_sessions_this_run\nwhere cast(True as boolean) --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.643432Z", "completed_at": "2024-05-14T15:34:05.660404Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.661280Z", "completed_at": "2024-05-14T15:34:05.661292Z"}], "thread_id": "Thread-3", "execution_time": 0.02194833755493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_users_sessions_this_run", "compiled": true, "compiled_code": "\n\n\n\nselect\n  a.*,\n  min(a.start_tstamp) over(partition by a.device_user_id) as user_start_tstamp,\n  max(a.end_tstamp) over(partition by a.device_user_id) as user_end_tstamp\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions a\nwhere exists (select 1 from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_base_sessions_this_run b where a.device_user_id = b.user_identifier)", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.650273Z", "completed_at": "2024-05-14T15:34:05.662223Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.664278Z", "completed_at": "2024-05-14T15:34:05.664287Z"}], "thread_id": "Thread-1", "execution_time": 0.023591041564941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile_integration_tests.snowplow_mobile_sessions_actual", "compiled": true, "compiled_code": "\n\n\nselect\n  app_id,\n  session_id,\n  session_index,\n  previous_session_id,\n  session_first_event_id,\n  session_last_event_id,\n  start_tstamp,\n  end_tstamp,\n  model_tstamp,\n  user_id,\n  device_user_id,\n  network_userid,\n  stitched_user_id,\n  -- fix rounding inconsistencies in BQ\n  \n    session_duration_s,\n  \n  has_install,\n  screen_views,\n  screen_names_viewed,\n  app_errors,\n  fatal_app_errors,\n  first_event_name,\n  last_event_name,\n  first_screen_view_name,\n  first_screen_view_transition_type,\n  first_screen_view_type,\n  last_screen_view_name,\n  last_screen_view_transition_type,\n  last_screen_view_type,\n  platform,\n  dvce_screenwidth,\n  dvce_screenheight,\n  device_manufacturer,\n  device_model,\n  os_type,\n  os_version,\n  android_idfa,\n  apple_idfa,\n  apple_idfv,\n  open_idfa,\n  device_latitude,\n  device_longitude,\n  device_latitude_longitude_accuracy,\n  device_altitude,\n  device_altitude_accuracy,\n  device_bearing,\n  device_speed,\n  geo_country,\n  geo_region,\n  geo_city,\n  geo_zipcode,\n  geo_latitude,\n  geo_longitude,\n  geo_region_name,\n  geo_timezone,\n  user_ipaddress,\n  useragent,\n  name_tracker,\n  v_tracker,\n  carrier,\n  network_technology,\n  network_type,\n  first_build,\n  last_build,\n  first_version,\n  last_version\n\n  , event_id\n  , event_id2\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_sessions_actual"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.655416Z", "completed_at": "2024-05-14T15:34:05.663671Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.666197Z", "completed_at": "2024-05-14T15:34:05.666205Z"}], "thread_id": "Thread-2", "execution_time": 0.02414989471435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_device_user_id.a086c474b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.669943Z", "completed_at": "2024-05-14T15:34:05.681108Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.687762Z", "completed_at": "2024-05-14T15:34:05.687772Z"}], "thread_id": "Thread-3", "execution_time": 0.022363662719726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_end_tstamp.0df87bb605", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.681894Z", "completed_at": "2024-05-14T15:34:05.689705Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.691641Z", "completed_at": "2024-05-14T15:34:05.691650Z"}], "thread_id": "Thread-2", "execution_time": 0.01718878746032715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_last_event_name.7f038373ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_event_name\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere last_event_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.676572Z", "completed_at": "2024-05-14T15:34:05.690928Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.693172Z", "completed_at": "2024-05-14T15:34:05.693180Z"}], "thread_id": "Thread-1", "execution_time": 0.023996829986572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_has_install.96de7ec6fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect has_install\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere has_install is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.694786Z", "completed_at": "2024-05-14T15:34:05.702193Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.707977Z", "completed_at": "2024-05-14T15:34:05.707986Z"}], "thread_id": "Thread-3", "execution_time": 0.01779007911682129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_model_tstamp.af040400b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere model_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.703371Z", "completed_at": "2024-05-14T15:34:05.714542Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.716500Z", "completed_at": "2024-05-14T15:34:05.716509Z"}], "thread_id": "Thread-2", "execution_time": 0.016506433486938477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_network_userid.0ec84f0c0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere network_userid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.708907Z", "completed_at": "2024-05-14T15:34:05.715889Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.718077Z", "completed_at": "2024-05-14T15:34:05.718084Z"}], "thread_id": "Thread-1", "execution_time": 0.01733875274658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_session_duration_s.cb0905de1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_duration_s\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere session_duration_s is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.719697Z", "completed_at": "2024-05-14T15:34:05.728028Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.738798Z", "completed_at": "2024-05-14T15:34:05.738809Z"}], "thread_id": "Thread-3", "execution_time": 0.023692607879638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_session_first_event_id.0066b8842e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_first_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere session_first_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.734365Z", "completed_at": "2024-05-14T15:34:05.741534Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.743428Z", "completed_at": "2024-05-14T15:34:05.743435Z"}], "thread_id": "Thread-1", "execution_time": 0.017411470413208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_session_index.d209560f11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_index\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere session_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.728686Z", "completed_at": "2024-05-14T15:34:05.742828Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.748756Z", "completed_at": "2024-05-14T15:34:05.748765Z"}], "thread_id": "Thread-2", "execution_time": 0.023500919342041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_session_id.c7caf76f78", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.744345Z", "completed_at": "2024-05-14T15:34:05.751305Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.753230Z", "completed_at": "2024-05-14T15:34:05.753238Z"}], "thread_id": "Thread-3", "execution_time": 0.012584924697875977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_session_last_event_id.b4da71eb52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_last_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere session_last_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.756003Z", "completed_at": "2024-05-14T15:34:05.774763Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.775420Z", "completed_at": "2024-05-14T15:34:05.775428Z"}], "thread_id": "Thread-1", "execution_time": 0.023639202117919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_sessions_start_tstamp.5249ac0ea2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.760648Z", "completed_at": "2024-05-14T15:34:05.778478Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.783605Z", "completed_at": "2024-05-14T15:34:05.783618Z"}], "thread_id": "Thread-2", "execution_time": 0.031229496002197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_sessions_session_id.f65b6b17c2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_sessions\nwhere session_id is not null\ngroup by session_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.766807Z", "completed_at": "2024-05-14T15:34:05.784674Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.786169Z", "completed_at": "2024-05-14T15:34:05.786178Z"}], "thread_id": "Thread-3", "execution_time": 0.02105998992919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_users_aggs", "compiled": true, "compiled_code": "\n\n\n\nselect\n  device_user_id,\n  -- time\n  user_start_tstamp as start_tstamp,\n  user_end_tstamp as end_tstamp,\n  -- first/last session. Max to resolve edge case with multiple sessions with the same start/end tstamp\n  \n    max(case when start_tstamp = user_start_tstamp then session_id end) as first_session_id,\n    max(case when end_tstamp = user_end_tstamp then session_id end) as last_session_id,\n  \n  -- engagement\n  sum(screen_views) as screen_views,\n  sum(screen_names_viewed) as screen_names_viewed,\n  count(distinct session_id) as sessions,\n  sum(session_duration_s) as sessions_duration_s,\n  count(distinct date_trunc('day', start_tstamp)) as active_days,\n  sum(app_errors) as app_errors,\n  sum(fatal_app_errors) as fatal_app_errors\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\n\ngroup by 1,2,3", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.779081Z", "completed_at": "2024-05-14T15:34:05.787098Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.789137Z", "completed_at": "2024-05-14T15:34:05.789145Z"}], "thread_id": "Thread-1", "execution_time": 0.012150764465332031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_device_user_id.8a73c78fb1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.792201Z", "completed_at": "2024-05-14T15:34:05.803334Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.809652Z", "completed_at": "2024-05-14T15:34:05.809661Z"}], "thread_id": "Thread-2", "execution_time": 0.022069215774536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_end_tstamp.06de4846cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.798225Z", "completed_at": "2024-05-14T15:34:05.808915Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.810651Z", "completed_at": "2024-05-14T15:34:05.810661Z"}], "thread_id": "Thread-3", "execution_time": 0.019899845123291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_has_install.159e4d5f19", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect has_install\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere has_install is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.804059Z", "completed_at": "2024-05-14T15:34:05.812219Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.814292Z", "completed_at": "2024-05-14T15:34:05.814300Z"}], "thread_id": "Thread-1", "execution_time": 0.016941547393798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_last_event_name.6a5971820a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_event_name\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere last_event_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.817807Z", "completed_at": "2024-05-14T15:34:05.829553Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.835497Z", "completed_at": "2024-05-14T15:34:05.835506Z"}], "thread_id": "Thread-2", "execution_time": 0.021984100341796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_model_tstamp.d76fbd1328", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere model_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.824118Z", "completed_at": "2024-05-14T15:34:05.836424Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.837997Z", "completed_at": "2024-05-14T15:34:05.838006Z"}], "thread_id": "Thread-3", "execution_time": 0.022896289825439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_network_userid.66574607a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere network_userid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:04.901879Z", "completed_at": "2024-05-14T15:34:05.523275Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.524036Z", "completed_at": "2024-05-14T15:34:05.524047Z"}], "thread_id": "Thread-4", "execution_time": 0.9455437660217285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile_integration_tests.snowplow_mobile_integration_tests_equality_snowplow_mobile_screen_views_actual_screen_view_id__event_id__app_id__user_id__device_user_id__network_userid__session_id__session_index__previous_session_id__session_first_event_id__screen_view_in_session_index__screen_views_in_session__dvce_created_tstamp__collector_tstamp__derived_tstamp__screen_view_name__screen_view_transition_type__screen_view_type__screen_fragment__screen_top_view_controller__screen_view_controller__screen_view_previous_id__screen_view_previous_name__screen_view_previous_type__platform__dvce_screenwidth__dvce_screenheight__device_manufacturer__device_model__os_type__os_version__android_idfa__apple_idfa__apple_idfv__open_idfa__device_latitude__device_longitude__device_latitude_longitude_accuracy__device_altitude__device_altitude_accuracy__device_bearing__device_speed__geo_country__geo_region__geo_city__geo_zipcode__geo_latitude__geo_longitude__geo_region_name__geo_timezone__user_ipaddress__useragent__carrier__network_technology__network_type__build__version__event_id2__ref_snowplow_mobile_screen_views_expected_stg___4.23a9bbdccb", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_screen_views_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_screen_views_expected_stg\n\n),\n\na_minus_b as (\n\n    select SCREEN_VIEW_ID, EVENT_ID, APP_ID, USER_ID, DEVICE_USER_ID, NETWORK_USERID, SESSION_ID, round(cast(SESSION_INDEX as numeric(28,6)),4) as SESSION_INDEX, PREVIOUS_SESSION_ID, SESSION_FIRST_EVENT_ID, round(cast(SCREEN_VIEW_IN_SESSION_INDEX as numeric(28,6)),4) as SCREEN_VIEW_IN_SESSION_INDEX, round(cast(SCREEN_VIEWS_IN_SESSION as numeric(28,6)),4) as SCREEN_VIEWS_IN_SESSION, DVCE_CREATED_TSTAMP, COLLECTOR_TSTAMP, DERIVED_TSTAMP, SCREEN_VIEW_NAME, SCREEN_VIEW_TRANSITION_TYPE, SCREEN_VIEW_TYPE, SCREEN_FRAGMENT, SCREEN_TOP_VIEW_CONTROLLER, SCREEN_VIEW_CONTROLLER, SCREEN_VIEW_PREVIOUS_ID, SCREEN_VIEW_PREVIOUS_NAME, SCREEN_VIEW_PREVIOUS_TYPE, PLATFORM, round(cast(DVCE_SCREENWIDTH as numeric(28,6)),4) as DVCE_SCREENWIDTH, round(cast(DVCE_SCREENHEIGHT as numeric(28,6)),4) as DVCE_SCREENHEIGHT, DEVICE_MANUFACTURER, DEVICE_MODEL, OS_TYPE, OS_VERSION, ANDROID_IDFA, APPLE_IDFA, APPLE_IDFV, OPEN_IDFA, round(cast(DEVICE_LATITUDE as numeric(28,6)),4) as DEVICE_LATITUDE, round(cast(DEVICE_LONGITUDE as numeric(28,6)),4) as DEVICE_LONGITUDE, round(cast(DEVICE_LATITUDE_LONGITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_LATITUDE_LONGITUDE_ACCURACY, round(cast(DEVICE_ALTITUDE as numeric(28,6)),4) as DEVICE_ALTITUDE, round(cast(DEVICE_ALTITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_ALTITUDE_ACCURACY, round(cast(DEVICE_BEARING as numeric(28,6)),4) as DEVICE_BEARING, round(cast(DEVICE_SPEED as numeric(28,6)),4) as DEVICE_SPEED, GEO_COUNTRY, GEO_REGION, GEO_CITY, GEO_ZIPCODE, round(cast(GEO_LATITUDE as numeric(28,6)),4) as GEO_LATITUDE, round(cast(GEO_LONGITUDE as numeric(28,6)),4) as GEO_LONGITUDE, GEO_REGION_NAME, GEO_TIMEZONE, USER_IPADDRESS, USERAGENT, CARRIER, NETWORK_TECHNOLOGY, NETWORK_TYPE, BUILD, VERSION, EVENT_ID2 from a\n    \n\n    except\n\n\n    select SCREEN_VIEW_ID, EVENT_ID, APP_ID, USER_ID, DEVICE_USER_ID, NETWORK_USERID, SESSION_ID, round(cast(SESSION_INDEX as numeric(28,6)),4) as SESSION_INDEX, PREVIOUS_SESSION_ID, SESSION_FIRST_EVENT_ID, round(cast(SCREEN_VIEW_IN_SESSION_INDEX as numeric(28,6)),4) as SCREEN_VIEW_IN_SESSION_INDEX, round(cast(SCREEN_VIEWS_IN_SESSION as numeric(28,6)),4) as SCREEN_VIEWS_IN_SESSION, DVCE_CREATED_TSTAMP, COLLECTOR_TSTAMP, DERIVED_TSTAMP, SCREEN_VIEW_NAME, SCREEN_VIEW_TRANSITION_TYPE, SCREEN_VIEW_TYPE, SCREEN_FRAGMENT, SCREEN_TOP_VIEW_CONTROLLER, SCREEN_VIEW_CONTROLLER, SCREEN_VIEW_PREVIOUS_ID, SCREEN_VIEW_PREVIOUS_NAME, SCREEN_VIEW_PREVIOUS_TYPE, PLATFORM, round(cast(DVCE_SCREENWIDTH as numeric(28,6)),4) as DVCE_SCREENWIDTH, round(cast(DVCE_SCREENHEIGHT as numeric(28,6)),4) as DVCE_SCREENHEIGHT, DEVICE_MANUFACTURER, DEVICE_MODEL, OS_TYPE, OS_VERSION, ANDROID_IDFA, APPLE_IDFA, APPLE_IDFV, OPEN_IDFA, round(cast(DEVICE_LATITUDE as numeric(28,6)),4) as DEVICE_LATITUDE, round(cast(DEVICE_LONGITUDE as numeric(28,6)),4) as DEVICE_LONGITUDE, round(cast(DEVICE_LATITUDE_LONGITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_LATITUDE_LONGITUDE_ACCURACY, round(cast(DEVICE_ALTITUDE as numeric(28,6)),4) as DEVICE_ALTITUDE, round(cast(DEVICE_ALTITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_ALTITUDE_ACCURACY, round(cast(DEVICE_BEARING as numeric(28,6)),4) as DEVICE_BEARING, round(cast(DEVICE_SPEED as numeric(28,6)),4) as DEVICE_SPEED, GEO_COUNTRY, GEO_REGION, GEO_CITY, GEO_ZIPCODE, round(cast(GEO_LATITUDE as numeric(28,6)),4) as GEO_LATITUDE, round(cast(GEO_LONGITUDE as numeric(28,6)),4) as GEO_LONGITUDE, GEO_REGION_NAME, GEO_TIMEZONE, USER_IPADDRESS, USERAGENT, CARRIER, NETWORK_TECHNOLOGY, NETWORK_TYPE, BUILD, VERSION, EVENT_ID2 from b\n\n),\n\nb_minus_a as (\n\n    select SCREEN_VIEW_ID, EVENT_ID, APP_ID, USER_ID, DEVICE_USER_ID, NETWORK_USERID, SESSION_ID, round(cast(SESSION_INDEX as numeric(28,6)),4) as SESSION_INDEX, PREVIOUS_SESSION_ID, SESSION_FIRST_EVENT_ID, round(cast(SCREEN_VIEW_IN_SESSION_INDEX as numeric(28,6)),4) as SCREEN_VIEW_IN_SESSION_INDEX, round(cast(SCREEN_VIEWS_IN_SESSION as numeric(28,6)),4) as SCREEN_VIEWS_IN_SESSION, DVCE_CREATED_TSTAMP, COLLECTOR_TSTAMP, DERIVED_TSTAMP, SCREEN_VIEW_NAME, SCREEN_VIEW_TRANSITION_TYPE, SCREEN_VIEW_TYPE, SCREEN_FRAGMENT, SCREEN_TOP_VIEW_CONTROLLER, SCREEN_VIEW_CONTROLLER, SCREEN_VIEW_PREVIOUS_ID, SCREEN_VIEW_PREVIOUS_NAME, SCREEN_VIEW_PREVIOUS_TYPE, PLATFORM, round(cast(DVCE_SCREENWIDTH as numeric(28,6)),4) as DVCE_SCREENWIDTH, round(cast(DVCE_SCREENHEIGHT as numeric(28,6)),4) as DVCE_SCREENHEIGHT, DEVICE_MANUFACTURER, DEVICE_MODEL, OS_TYPE, OS_VERSION, ANDROID_IDFA, APPLE_IDFA, APPLE_IDFV, OPEN_IDFA, round(cast(DEVICE_LATITUDE as numeric(28,6)),4) as DEVICE_LATITUDE, round(cast(DEVICE_LONGITUDE as numeric(28,6)),4) as DEVICE_LONGITUDE, round(cast(DEVICE_LATITUDE_LONGITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_LATITUDE_LONGITUDE_ACCURACY, round(cast(DEVICE_ALTITUDE as numeric(28,6)),4) as DEVICE_ALTITUDE, round(cast(DEVICE_ALTITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_ALTITUDE_ACCURACY, round(cast(DEVICE_BEARING as numeric(28,6)),4) as DEVICE_BEARING, round(cast(DEVICE_SPEED as numeric(28,6)),4) as DEVICE_SPEED, GEO_COUNTRY, GEO_REGION, GEO_CITY, GEO_ZIPCODE, round(cast(GEO_LATITUDE as numeric(28,6)),4) as GEO_LATITUDE, round(cast(GEO_LONGITUDE as numeric(28,6)),4) as GEO_LONGITUDE, GEO_REGION_NAME, GEO_TIMEZONE, USER_IPADDRESS, USERAGENT, CARRIER, NETWORK_TECHNOLOGY, NETWORK_TYPE, BUILD, VERSION, EVENT_ID2 from b\n    \n\n    except\n\n\n    select SCREEN_VIEW_ID, EVENT_ID, APP_ID, USER_ID, DEVICE_USER_ID, NETWORK_USERID, SESSION_ID, round(cast(SESSION_INDEX as numeric(28,6)),4) as SESSION_INDEX, PREVIOUS_SESSION_ID, SESSION_FIRST_EVENT_ID, round(cast(SCREEN_VIEW_IN_SESSION_INDEX as numeric(28,6)),4) as SCREEN_VIEW_IN_SESSION_INDEX, round(cast(SCREEN_VIEWS_IN_SESSION as numeric(28,6)),4) as SCREEN_VIEWS_IN_SESSION, DVCE_CREATED_TSTAMP, COLLECTOR_TSTAMP, DERIVED_TSTAMP, SCREEN_VIEW_NAME, SCREEN_VIEW_TRANSITION_TYPE, SCREEN_VIEW_TYPE, SCREEN_FRAGMENT, SCREEN_TOP_VIEW_CONTROLLER, SCREEN_VIEW_CONTROLLER, SCREEN_VIEW_PREVIOUS_ID, SCREEN_VIEW_PREVIOUS_NAME, SCREEN_VIEW_PREVIOUS_TYPE, PLATFORM, round(cast(DVCE_SCREENWIDTH as numeric(28,6)),4) as DVCE_SCREENWIDTH, round(cast(DVCE_SCREENHEIGHT as numeric(28,6)),4) as DVCE_SCREENHEIGHT, DEVICE_MANUFACTURER, DEVICE_MODEL, OS_TYPE, OS_VERSION, ANDROID_IDFA, APPLE_IDFA, APPLE_IDFV, OPEN_IDFA, round(cast(DEVICE_LATITUDE as numeric(28,6)),4) as DEVICE_LATITUDE, round(cast(DEVICE_LONGITUDE as numeric(28,6)),4) as DEVICE_LONGITUDE, round(cast(DEVICE_LATITUDE_LONGITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_LATITUDE_LONGITUDE_ACCURACY, round(cast(DEVICE_ALTITUDE as numeric(28,6)),4) as DEVICE_ALTITUDE, round(cast(DEVICE_ALTITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_ALTITUDE_ACCURACY, round(cast(DEVICE_BEARING as numeric(28,6)),4) as DEVICE_BEARING, round(cast(DEVICE_SPEED as numeric(28,6)),4) as DEVICE_SPEED, GEO_COUNTRY, GEO_REGION, GEO_CITY, GEO_ZIPCODE, round(cast(GEO_LATITUDE as numeric(28,6)),4) as GEO_LATITUDE, round(cast(GEO_LONGITUDE as numeric(28,6)),4) as GEO_LONGITUDE, GEO_REGION_NAME, GEO_TIMEZONE, USER_IPADDRESS, USERAGENT, CARRIER, NETWORK_TECHNOLOGY, NETWORK_TYPE, BUILD, VERSION, EVENT_ID2 from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.830261Z", "completed_at": "2024-05-14T15:34:05.840720Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.843432Z", "completed_at": "2024-05-14T15:34:05.843440Z"}], "thread_id": "Thread-1", "execution_time": 0.020094871520996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_session_duration_s.7f1392a39a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_duration_s\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere session_duration_s is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.845037Z", "completed_at": "2024-05-14T15:34:05.853479Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.865289Z", "completed_at": "2024-05-14T15:34:05.865298Z"}], "thread_id": "Thread-2", "execution_time": 0.0263822078704834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_session_first_event_id.e95435adb7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_first_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere session_first_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.854201Z", "completed_at": "2024-05-14T15:34:05.871846Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.874628Z", "completed_at": "2024-05-14T15:34:05.874637Z"}], "thread_id": "Thread-3", "execution_time": 0.030388832092285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_session_id.60dd7c6df6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.858703Z", "completed_at": "2024-05-14T15:34:05.872587Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.875540Z", "completed_at": "2024-05-14T15:34:05.875548Z"}], "thread_id": "Thread-4", "execution_time": 0.025722265243530273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_session_index.37c6e38d89", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_index\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere session_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.866446Z", "completed_at": "2024-05-14T15:34:05.873303Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.876442Z", "completed_at": "2024-05-14T15:34:05.876450Z"}], "thread_id": "Thread-1", "execution_time": 0.023747920989990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_session_last_event_id.4096c1b420", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_last_event_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere session_last_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.880112Z", "completed_at": "2024-05-14T15:34:05.888796Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.905342Z", "completed_at": "2024-05-14T15:34:05.905353Z"}], "thread_id": "Thread-2", "execution_time": 0.031516313552856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_this_run_start_tstamp.ee8588939a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.889438Z", "completed_at": "2024-05-14T15:34:05.907542Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.909739Z", "completed_at": "2024-05-14T15:34:05.909747Z"}], "thread_id": "Thread-3", "execution_time": 0.025099754333496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_users_sessions_this_run_previous_session_id.44c04d5b6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    previous_session_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere previous_session_id is not null\ngroup by previous_session_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.899692Z", "completed_at": "2024-05-14T15:34:05.909137Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.911991Z", "completed_at": "2024-05-14T15:34:05.912000Z"}], "thread_id": "Thread-1", "execution_time": 0.025938987731933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile_integration_tests.dbt_utils_equal_rowcount_snowplow_mobile_sessions_actual_ref_snowplow_mobile_sessions_expected_stg_.957914d24d", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_sessions_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_sessions_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.894119Z", "completed_at": "2024-05-14T15:34:05.910623Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.913665Z", "completed_at": "2024-05-14T15:34:05.913675Z"}], "thread_id": "Thread-4", "execution_time": 0.028310060501098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_users_sessions_this_run_session_id.5f350b34fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run\nwhere session_id is not null\ngroup by session_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.929366Z", "completed_at": "2024-05-14T15:34:05.949902Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.951817Z", "completed_at": "2024-05-14T15:34:05.951826Z"}], "thread_id": "Thread-3", "execution_time": 0.02814650535583496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_users_lasts", "compiled": true, "compiled_code": "\n\n\n\nselect\n  a.device_user_id,\n  a.last_screen_view_name,\n  a.last_screen_view_transition_type,\n  a.last_screen_view_type,\n  a.carrier AS last_carrier,\n  a.os_version AS last_os_version\n    ,a.event_id as last_event_id\n    ,event_id2 || '-last' as last_event_id2\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run a\n\ninner join SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs b\non a.session_id = b.last_session_id", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_lasts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.937624Z", "completed_at": "2024-05-14T15:34:05.950633Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.952738Z", "completed_at": "2024-05-14T15:34:05.952746Z"}], "thread_id": "Thread-1", "execution_time": 0.026734590530395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_aggs_active_days.cdc2d3a7be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_days\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere active_days is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.944779Z", "completed_at": "2024-05-14T15:34:05.951226Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.953703Z", "completed_at": "2024-05-14T15:34:05.953714Z"}], "thread_id": "Thread-4", "execution_time": 0.02643442153930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_aggs_device_user_id.21a25dd125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.960709Z", "completed_at": "2024-05-14T15:34:05.974779Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.975452Z", "completed_at": "2024-05-14T15:34:05.975461Z"}], "thread_id": "Thread-3", "execution_time": 0.018618106842041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_aggs_end_tstamp.77ff972362", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.965324Z", "completed_at": "2024-05-14T15:34:05.977127Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.979043Z", "completed_at": "2024-05-14T15:34:05.979050Z"}], "thread_id": "Thread-1", "execution_time": 0.02153778076171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_aggs_first_session_id.4d39c76138", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere first_session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.969919Z", "completed_at": "2024-05-14T15:34:05.977757Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:05.979948Z", "completed_at": "2024-05-14T15:34:05.979958Z"}], "thread_id": "Thread-4", "execution_time": 0.021780729293823242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_aggs_last_session_id.5becbb7657", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_session_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere last_session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.982942Z", "completed_at": "2024-05-14T15:34:05.991178Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.000989Z", "completed_at": "2024-05-14T15:34:06.000999Z"}], "thread_id": "Thread-3", "execution_time": 0.022778749465942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_aggs_sessions.6da0e97ed1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sessions\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere sessions is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.991768Z", "completed_at": "2024-05-14T15:34:06.008797Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.009706Z", "completed_at": "2024-05-14T15:34:06.009715Z"}], "thread_id": "Thread-1", "execution_time": 0.021383285522460938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_aggs_sessions_duration_s.542133b866", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sessions_duration_s\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere sessions_duration_s is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.996321Z", "completed_at": "2024-05-14T15:34:06.022188Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.022898Z", "completed_at": "2024-05-14T15:34:06.022907Z"}], "thread_id": "Thread-4", "execution_time": 0.033846139907836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_aggs_start_tstamp.c0e7994cc6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.004124Z", "completed_at": "2024-05-14T15:34:06.024494Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.025862Z", "completed_at": "2024-05-14T15:34:06.025871Z"}], "thread_id": "Thread-3", "execution_time": 0.02312469482421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_users_aggs_device_user_id.886f6fffe9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_user_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs\nwhere device_user_id is not null\ngroup by device_user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.012662Z", "completed_at": "2024-05-14T15:34:06.026767Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.028712Z", "completed_at": "2024-05-14T15:34:06.028720Z"}], "thread_id": "Thread-1", "execution_time": 0.017406225204467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_users_this_run", "compiled": true, "compiled_code": "\n\n\n\nselect\n\n    -- user fields\n    a.user_identifier,\n    a.original_device_user_id,\n    a.user_id,\n    a.device_user_id,\n    a.network_userid,\n\n    b.start_tstamp,\n    b.end_tstamp,\n    convert_timezone('UTC', current_timestamp()) AS model_tstamp,\n\n    -- engagement fields\n    b.screen_views,\n    b.screen_names_viewed,\n    b.sessions,\n    b.sessions_duration_s,\n    b.active_days,\n    --errors\n    b.app_errors,\n    b.fatal_app_errors,\n\n    -- screen fields\n    a.first_screen_view_name,\n    a.first_screen_view_transition_type,\n    a.first_screen_view_type,\n\n    c.last_screen_view_name,\n    c.last_screen_view_transition_type,\n    c.last_screen_view_type,\n\n    -- device fields\n    a.platform,\n    a.dvce_screenwidth,\n    a.dvce_screenheight,\n    a.device_manufacturer,\n    a.device_model,\n    a.os_type,\n    a.os_version first_os_version,\n    c.last_os_version,\n    a.android_idfa,\n    a.apple_idfa,\n    a.apple_idfv,\n    a.open_idfa,\n    a.carrier first_carrier,\n    c.last_carrier,\n\n    -- geo fields\n    a.geo_country,\n    a.geo_region,\n    a.geo_city,\n    a.geo_zipcode,\n    a.geo_latitude,\n    a.geo_longitude,\n    a.geo_region_name,\n    a.geo_timezone\n      ,a.event_id as first_event_id\n      ,event_id2 || '-first' as first_event_id2\n      ,c.last_event_id\n      ,c.last_event_id2\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_aggs as b\n\ninner join SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_sessions_this_run as a\non a.session_id = b.first_session_id\n\ninner join SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_lasts c\non b.device_user_id = c.device_user_id", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.029684Z", "completed_at": "2024-05-14T15:34:06.036118Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.038176Z", "completed_at": "2024-05-14T15:34:06.038186Z"}], "thread_id": "Thread-4", "execution_time": 0.013125896453857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_lasts_device_user_id.3c25d94895", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_lasts\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.039126Z", "completed_at": "2024-05-14T15:34:06.050853Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.059711Z", "completed_at": "2024-05-14T15:34:06.059725Z"}], "thread_id": "Thread-3", "execution_time": 0.025650501251220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_users_lasts_device_user_id.1f3f63f4c0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_user_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_lasts\nwhere device_user_id is not null\ngroup by device_user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.063447Z", "completed_at": "2024-05-14T15:34:06.078232Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.078890Z", "completed_at": "2024-05-14T15:34:06.078902Z"}], "thread_id": "Thread-4", "execution_time": 0.020188093185424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_this_run_active_days.e34ee21830", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_days\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere active_days is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.071993Z", "completed_at": "2024-05-14T15:34:06.080495Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.081891Z", "completed_at": "2024-05-14T15:34:06.081900Z"}], "thread_id": "Thread-3", "execution_time": 0.013529777526855469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_this_run_device_user_id.9221407686", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.084132Z", "completed_at": "2024-05-14T15:34:06.094807Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.095434Z", "completed_at": "2024-05-14T15:34:06.095443Z"}], "thread_id": "Thread-4", "execution_time": 0.014373779296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_this_run_end_tstamp.135cb78b5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.090245Z", "completed_at": "2024-05-14T15:34:06.098383Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.103517Z", "completed_at": "2024-05-14T15:34:06.103527Z"}], "thread_id": "Thread-3", "execution_time": 0.014816761016845703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_this_run_model_tstamp.c7afd66f05", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere model_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.098972Z", "completed_at": "2024-05-14T15:34:06.111018Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.111712Z", "completed_at": "2024-05-14T15:34:06.111720Z"}], "thread_id": "Thread-4", "execution_time": 0.014758586883544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_this_run_network_userid.72ef775109", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere network_userid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.106586Z", "completed_at": "2024-05-14T15:34:06.114018Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.115197Z", "completed_at": "2024-05-14T15:34:06.115206Z"}], "thread_id": "Thread-3", "execution_time": 0.00996851921081543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_this_run_sessions.af8caf4e67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sessions\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere sessions is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.116095Z", "completed_at": "2024-05-14T15:34:06.128235Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.128967Z", "completed_at": "2024-05-14T15:34:06.128979Z"}], "thread_id": "Thread-4", "execution_time": 0.015753984451293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_this_run_sessions_duration_s.327d7065aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sessions_duration_s\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere sessions_duration_s is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.123800Z", "completed_at": "2024-05-14T15:34:06.136461Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.137122Z", "completed_at": "2024-05-14T15:34:06.137130Z"}], "thread_id": "Thread-3", "execution_time": 0.014813423156738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_this_run_start_tstamp.f731eeb58e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.131801Z", "completed_at": "2024-05-14T15:34:06.138122Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.138710Z", "completed_at": "2024-05-14T15:34:06.138717Z"}], "thread_id": "Thread-4", "execution_time": 0.008273124694824219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_users_this_run_device_user_id.adee81cbe8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_user_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere device_user_id is not null\ngroup by device_user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:05.914604Z", "completed_at": "2024-05-14T15:34:06.569814Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.570551Z", "completed_at": "2024-05-14T15:34:06.570565Z"}], "thread_id": "Thread-2", "execution_time": 0.8813233375549316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile_integration_tests.snowplow_mobile_integration_tests_equality_snowplow_mobile_sessions_actual_app_id__session_id__session_index__previous_session_id__session_first_event_id__session_last_event_id__start_tstamp__end_tstamp__user_id__device_user_id__network_userid__stitched_user_id__session_duration_s__has_install__screen_views__screen_names_viewed__app_errors__fatal_app_errors__first_event_name__last_event_name__first_screen_view_name__first_screen_view_transition_type__first_screen_view_type__last_screen_view_name__last_screen_view_transition_type__last_screen_view_type__platform__dvce_screenwidth__dvce_screenheight__device_manufacturer__device_model__os_type__os_version__android_idfa__apple_idfa__apple_idfv__open_idfa__device_latitude__device_longitude__device_latitude_longitude_accuracy__device_altitude__device_altitude_accuracy__device_bearing__device_speed__geo_country__geo_region__geo_city__geo_zipcode__geo_latitude__geo_longitude__geo_region_name__geo_timezone__user_ipaddress__useragent__name_tracker__v_tracker__carrier__network_technology__network_type__first_build__last_build__first_version__last_version__event_id2__ref_snowplow_mobile_sessions_expected_stg___4.36233a8400", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_sessions_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_sessions_expected_stg\n\n),\n\na_minus_b as (\n\n    select APP_ID, SESSION_ID, round(cast(SESSION_INDEX as numeric(28,6)),4) as SESSION_INDEX, PREVIOUS_SESSION_ID, SESSION_FIRST_EVENT_ID, SESSION_LAST_EVENT_ID, START_TSTAMP, END_TSTAMP, USER_ID, DEVICE_USER_ID, NETWORK_USERID, STITCHED_USER_ID, round(cast(SESSION_DURATION_S as numeric(28,6)),4) as SESSION_DURATION_S, HAS_INSTALL, round(cast(SCREEN_VIEWS as numeric(28,6)),4) as SCREEN_VIEWS, round(cast(SCREEN_NAMES_VIEWED as numeric(28,6)),4) as SCREEN_NAMES_VIEWED, round(cast(APP_ERRORS as numeric(28,6)),4) as APP_ERRORS, round(cast(FATAL_APP_ERRORS as numeric(28,6)),4) as FATAL_APP_ERRORS, FIRST_EVENT_NAME, LAST_EVENT_NAME, FIRST_SCREEN_VIEW_NAME, FIRST_SCREEN_VIEW_TRANSITION_TYPE, FIRST_SCREEN_VIEW_TYPE, LAST_SCREEN_VIEW_NAME, LAST_SCREEN_VIEW_TRANSITION_TYPE, LAST_SCREEN_VIEW_TYPE, PLATFORM, round(cast(DVCE_SCREENWIDTH as numeric(28,6)),4) as DVCE_SCREENWIDTH, round(cast(DVCE_SCREENHEIGHT as numeric(28,6)),4) as DVCE_SCREENHEIGHT, DEVICE_MANUFACTURER, DEVICE_MODEL, OS_TYPE, OS_VERSION, ANDROID_IDFA, APPLE_IDFA, APPLE_IDFV, OPEN_IDFA, round(cast(DEVICE_LATITUDE as numeric(28,6)),4) as DEVICE_LATITUDE, round(cast(DEVICE_LONGITUDE as numeric(28,6)),4) as DEVICE_LONGITUDE, round(cast(DEVICE_LATITUDE_LONGITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_LATITUDE_LONGITUDE_ACCURACY, round(cast(DEVICE_ALTITUDE as numeric(28,6)),4) as DEVICE_ALTITUDE, round(cast(DEVICE_ALTITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_ALTITUDE_ACCURACY, round(cast(DEVICE_BEARING as numeric(28,6)),4) as DEVICE_BEARING, round(cast(DEVICE_SPEED as numeric(28,6)),4) as DEVICE_SPEED, GEO_COUNTRY, GEO_REGION, GEO_CITY, GEO_ZIPCODE, round(cast(GEO_LATITUDE as numeric(28,6)),4) as GEO_LATITUDE, round(cast(GEO_LONGITUDE as numeric(28,6)),4) as GEO_LONGITUDE, GEO_REGION_NAME, GEO_TIMEZONE, USER_IPADDRESS, USERAGENT, NAME_TRACKER, V_TRACKER, CARRIER, NETWORK_TECHNOLOGY, NETWORK_TYPE, FIRST_BUILD, LAST_BUILD, FIRST_VERSION, LAST_VERSION, EVENT_ID2 from a\n    \n\n    except\n\n\n    select APP_ID, SESSION_ID, round(cast(SESSION_INDEX as numeric(28,6)),4) as SESSION_INDEX, PREVIOUS_SESSION_ID, SESSION_FIRST_EVENT_ID, SESSION_LAST_EVENT_ID, START_TSTAMP, END_TSTAMP, USER_ID, DEVICE_USER_ID, NETWORK_USERID, STITCHED_USER_ID, round(cast(SESSION_DURATION_S as numeric(28,6)),4) as SESSION_DURATION_S, HAS_INSTALL, round(cast(SCREEN_VIEWS as numeric(28,6)),4) as SCREEN_VIEWS, round(cast(SCREEN_NAMES_VIEWED as numeric(28,6)),4) as SCREEN_NAMES_VIEWED, round(cast(APP_ERRORS as numeric(28,6)),4) as APP_ERRORS, round(cast(FATAL_APP_ERRORS as numeric(28,6)),4) as FATAL_APP_ERRORS, FIRST_EVENT_NAME, LAST_EVENT_NAME, FIRST_SCREEN_VIEW_NAME, FIRST_SCREEN_VIEW_TRANSITION_TYPE, FIRST_SCREEN_VIEW_TYPE, LAST_SCREEN_VIEW_NAME, LAST_SCREEN_VIEW_TRANSITION_TYPE, LAST_SCREEN_VIEW_TYPE, PLATFORM, round(cast(DVCE_SCREENWIDTH as numeric(28,6)),4) as DVCE_SCREENWIDTH, round(cast(DVCE_SCREENHEIGHT as numeric(28,6)),4) as DVCE_SCREENHEIGHT, DEVICE_MANUFACTURER, DEVICE_MODEL, OS_TYPE, OS_VERSION, ANDROID_IDFA, APPLE_IDFA, APPLE_IDFV, OPEN_IDFA, round(cast(DEVICE_LATITUDE as numeric(28,6)),4) as DEVICE_LATITUDE, round(cast(DEVICE_LONGITUDE as numeric(28,6)),4) as DEVICE_LONGITUDE, round(cast(DEVICE_LATITUDE_LONGITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_LATITUDE_LONGITUDE_ACCURACY, round(cast(DEVICE_ALTITUDE as numeric(28,6)),4) as DEVICE_ALTITUDE, round(cast(DEVICE_ALTITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_ALTITUDE_ACCURACY, round(cast(DEVICE_BEARING as numeric(28,6)),4) as DEVICE_BEARING, round(cast(DEVICE_SPEED as numeric(28,6)),4) as DEVICE_SPEED, GEO_COUNTRY, GEO_REGION, GEO_CITY, GEO_ZIPCODE, round(cast(GEO_LATITUDE as numeric(28,6)),4) as GEO_LATITUDE, round(cast(GEO_LONGITUDE as numeric(28,6)),4) as GEO_LONGITUDE, GEO_REGION_NAME, GEO_TIMEZONE, USER_IPADDRESS, USERAGENT, NAME_TRACKER, V_TRACKER, CARRIER, NETWORK_TECHNOLOGY, NETWORK_TYPE, FIRST_BUILD, LAST_BUILD, FIRST_VERSION, LAST_VERSION, EVENT_ID2 from b\n\n),\n\nb_minus_a as (\n\n    select APP_ID, SESSION_ID, round(cast(SESSION_INDEX as numeric(28,6)),4) as SESSION_INDEX, PREVIOUS_SESSION_ID, SESSION_FIRST_EVENT_ID, SESSION_LAST_EVENT_ID, START_TSTAMP, END_TSTAMP, USER_ID, DEVICE_USER_ID, NETWORK_USERID, STITCHED_USER_ID, round(cast(SESSION_DURATION_S as numeric(28,6)),4) as SESSION_DURATION_S, HAS_INSTALL, round(cast(SCREEN_VIEWS as numeric(28,6)),4) as SCREEN_VIEWS, round(cast(SCREEN_NAMES_VIEWED as numeric(28,6)),4) as SCREEN_NAMES_VIEWED, round(cast(APP_ERRORS as numeric(28,6)),4) as APP_ERRORS, round(cast(FATAL_APP_ERRORS as numeric(28,6)),4) as FATAL_APP_ERRORS, FIRST_EVENT_NAME, LAST_EVENT_NAME, FIRST_SCREEN_VIEW_NAME, FIRST_SCREEN_VIEW_TRANSITION_TYPE, FIRST_SCREEN_VIEW_TYPE, LAST_SCREEN_VIEW_NAME, LAST_SCREEN_VIEW_TRANSITION_TYPE, LAST_SCREEN_VIEW_TYPE, PLATFORM, round(cast(DVCE_SCREENWIDTH as numeric(28,6)),4) as DVCE_SCREENWIDTH, round(cast(DVCE_SCREENHEIGHT as numeric(28,6)),4) as DVCE_SCREENHEIGHT, DEVICE_MANUFACTURER, DEVICE_MODEL, OS_TYPE, OS_VERSION, ANDROID_IDFA, APPLE_IDFA, APPLE_IDFV, OPEN_IDFA, round(cast(DEVICE_LATITUDE as numeric(28,6)),4) as DEVICE_LATITUDE, round(cast(DEVICE_LONGITUDE as numeric(28,6)),4) as DEVICE_LONGITUDE, round(cast(DEVICE_LATITUDE_LONGITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_LATITUDE_LONGITUDE_ACCURACY, round(cast(DEVICE_ALTITUDE as numeric(28,6)),4) as DEVICE_ALTITUDE, round(cast(DEVICE_ALTITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_ALTITUDE_ACCURACY, round(cast(DEVICE_BEARING as numeric(28,6)),4) as DEVICE_BEARING, round(cast(DEVICE_SPEED as numeric(28,6)),4) as DEVICE_SPEED, GEO_COUNTRY, GEO_REGION, GEO_CITY, GEO_ZIPCODE, round(cast(GEO_LATITUDE as numeric(28,6)),4) as GEO_LATITUDE, round(cast(GEO_LONGITUDE as numeric(28,6)),4) as GEO_LONGITUDE, GEO_REGION_NAME, GEO_TIMEZONE, USER_IPADDRESS, USERAGENT, NAME_TRACKER, V_TRACKER, CARRIER, NETWORK_TECHNOLOGY, NETWORK_TYPE, FIRST_BUILD, LAST_BUILD, FIRST_VERSION, LAST_VERSION, EVENT_ID2 from b\n    \n\n    except\n\n\n    select APP_ID, SESSION_ID, round(cast(SESSION_INDEX as numeric(28,6)),4) as SESSION_INDEX, PREVIOUS_SESSION_ID, SESSION_FIRST_EVENT_ID, SESSION_LAST_EVENT_ID, START_TSTAMP, END_TSTAMP, USER_ID, DEVICE_USER_ID, NETWORK_USERID, STITCHED_USER_ID, round(cast(SESSION_DURATION_S as numeric(28,6)),4) as SESSION_DURATION_S, HAS_INSTALL, round(cast(SCREEN_VIEWS as numeric(28,6)),4) as SCREEN_VIEWS, round(cast(SCREEN_NAMES_VIEWED as numeric(28,6)),4) as SCREEN_NAMES_VIEWED, round(cast(APP_ERRORS as numeric(28,6)),4) as APP_ERRORS, round(cast(FATAL_APP_ERRORS as numeric(28,6)),4) as FATAL_APP_ERRORS, FIRST_EVENT_NAME, LAST_EVENT_NAME, FIRST_SCREEN_VIEW_NAME, FIRST_SCREEN_VIEW_TRANSITION_TYPE, FIRST_SCREEN_VIEW_TYPE, LAST_SCREEN_VIEW_NAME, LAST_SCREEN_VIEW_TRANSITION_TYPE, LAST_SCREEN_VIEW_TYPE, PLATFORM, round(cast(DVCE_SCREENWIDTH as numeric(28,6)),4) as DVCE_SCREENWIDTH, round(cast(DVCE_SCREENHEIGHT as numeric(28,6)),4) as DVCE_SCREENHEIGHT, DEVICE_MANUFACTURER, DEVICE_MODEL, OS_TYPE, OS_VERSION, ANDROID_IDFA, APPLE_IDFA, APPLE_IDFV, OPEN_IDFA, round(cast(DEVICE_LATITUDE as numeric(28,6)),4) as DEVICE_LATITUDE, round(cast(DEVICE_LONGITUDE as numeric(28,6)),4) as DEVICE_LONGITUDE, round(cast(DEVICE_LATITUDE_LONGITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_LATITUDE_LONGITUDE_ACCURACY, round(cast(DEVICE_ALTITUDE as numeric(28,6)),4) as DEVICE_ALTITUDE, round(cast(DEVICE_ALTITUDE_ACCURACY as numeric(28,6)),4) as DEVICE_ALTITUDE_ACCURACY, round(cast(DEVICE_BEARING as numeric(28,6)),4) as DEVICE_BEARING, round(cast(DEVICE_SPEED as numeric(28,6)),4) as DEVICE_SPEED, GEO_COUNTRY, GEO_REGION, GEO_CITY, GEO_ZIPCODE, round(cast(GEO_LATITUDE as numeric(28,6)),4) as GEO_LATITUDE, round(cast(GEO_LONGITUDE as numeric(28,6)),4) as GEO_LONGITUDE, GEO_REGION_NAME, GEO_TIMEZONE, USER_IPADDRESS, USERAGENT, NAME_TRACKER, V_TRACKER, CARRIER, NETWORK_TECHNOLOGY, NETWORK_TYPE, FIRST_BUILD, LAST_BUILD, FIRST_VERSION, LAST_VERSION, EVENT_ID2 from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:06.045779Z", "completed_at": "2024-05-14T15:34:06.800395Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:06.801076Z", "completed_at": "2024-05-14T15:34:06.801085Z"}], "thread_id": "Thread-1", "execution_time": 0.9955945014953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile.snowplow_mobile_users", "compiled": true, "compiled_code": "\n\n\n\nselect *\n  \nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_scratch.snowplow_mobile_users_this_run\nwhere cast(True as boolean) --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.041782Z", "completed_at": "2024-05-14T15:34:07.062888Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.064172Z", "completed_at": "2024-05-14T15:34:07.064186Z"}], "thread_id": "Thread-3", "execution_time": 0.02784276008605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_mobile_integration_tests.snowplow_mobile_users_actual", "compiled": true, "compiled_code": "\n\n--Removing model_tstamp\n\nselect\n  user_id,\n  device_user_id,\n  network_userid,\n  start_tstamp,\n  end_tstamp,\n  model_tstamp,\n  screen_views,\n  screen_names_viewed,\n  sessions,\n  -- fix rounding inconsistencies in BQ\n  \n    sessions_duration_s,\n  \n  active_days,\n  app_errors,\n  fatal_app_errors,\n  first_screen_view_name,\n  first_screen_view_transition_type,\n  first_screen_view_type,\n  last_screen_view_name,\n  last_screen_view_transition_type,\n  last_screen_view_type,\n  platform,\n  dvce_screenwidth,\n  dvce_screenheight,\n  device_manufacturer,\n  device_model,\n  os_type,\n  first_os_version,\n  last_os_version,\n  android_idfa,\n  apple_idfa,\n  apple_idfv,\n  open_idfa,\n  geo_country,\n  geo_region,\n  geo_city,\n  geo_zipcode,\n  geo_latitude,\n  geo_longitude,\n  geo_region_name,\n  geo_timezone,\n  first_carrier,\n  last_carrier\n\n  , first_event_id\n  , last_event_id\n  , first_event_id2\n  , last_event_id2\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users", "relation_name": "SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_users_actual"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.053562Z", "completed_at": "2024-05-14T15:34:07.065212Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.067960Z", "completed_at": "2024-05-14T15:34:07.067968Z"}], "thread_id": "Thread-2", "execution_time": 0.028361082077026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_device_user_id.a94718e8ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_user_id\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere device_user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.048808Z", "completed_at": "2024-05-14T15:34:07.066562Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.069572Z", "completed_at": "2024-05-14T15:34:07.069579Z"}], "thread_id": "Thread-4", "execution_time": 0.031228065490722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_active_days.1de8ee4c08", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_days\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere active_days is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.058294Z", "completed_at": "2024-05-14T15:34:07.067135Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.070455Z", "completed_at": "2024-05-14T15:34:07.070463Z"}], "thread_id": "Thread-1", "execution_time": 0.030112028121948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_end_tstamp.343fe914e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere end_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.074738Z", "completed_at": "2024-05-14T15:34:07.082667Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.097972Z", "completed_at": "2024-05-14T15:34:07.097981Z"}], "thread_id": "Thread-3", "execution_time": 0.029204368591308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_model_tstamp.c61adb775a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere model_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.089054Z", "completed_at": "2024-05-14T15:34:07.099308Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.102066Z", "completed_at": "2024-05-14T15:34:07.102075Z"}], "thread_id": "Thread-4", "execution_time": 0.022866249084472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions.252ab0d2fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sessions\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere sessions is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.083265Z", "completed_at": "2024-05-14T15:34:07.099968Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.102989Z", "completed_at": "2024-05-14T15:34:07.102997Z"}], "thread_id": "Thread-2", "execution_time": 0.029004573822021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_network_userid.786799841a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere network_userid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.093446Z", "completed_at": "2024-05-14T15:34:07.101469Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.104572Z", "completed_at": "2024-05-14T15:34:07.104579Z"}], "thread_id": "Thread-1", "execution_time": 0.024635791778564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_sessions_duration_s.2158171a5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sessions_duration_s\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere sessions_duration_s is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.109683Z", "completed_at": "2024-05-14T15:34:07.121575Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.136507Z", "completed_at": "2024-05-14T15:34:07.136517Z"}], "thread_id": "Thread-3", "execution_time": 0.03272724151611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.not_null_snowplow_mobile_users_start_tstamp.1a8d41ec76", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere start_tstamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.117003Z", "completed_at": "2024-05-14T15:34:07.137847Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.139897Z", "completed_at": "2024-05-14T15:34:07.139905Z"}], "thread_id": "Thread-4", "execution_time": 0.03166842460632324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile.unique_snowplow_mobile_users_device_user_id.52e338d0ee", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_user_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_derived.snowplow_mobile_users\nwhere device_user_id is not null\ngroup by device_user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.122250Z", "completed_at": "2024-05-14T15:34:07.138597Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.140817Z", "completed_at": "2024-05-14T15:34:07.140826Z"}], "thread_id": "Thread-2", "execution_time": 0.031903982162475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile_integration_tests.dbt_utils_equal_rowcount_snowplow_mobile_users_actual_ref_snowplow_mobile_users_expected_stg_.79817d5021", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_users_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_users_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-14T15:34:07.128735Z", "completed_at": "2024-05-14T15:34:07.139214Z"}, {"name": "execute", "started_at": "2024-05-14T15:34:07.141790Z", "completed_at": "2024-05-14T15:34:07.141798Z"}], "thread_id": "Thread-1", "execution_time": 0.027705669403076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_mobile_integration_tests.dbt_utils_equality_snowplow_mobile_users_actual_user_id__device_user_id__network_userid__start_tstamp__end_tstamp__screen_views__screen_names_viewed__sessions__sessions_duration_s__active_days__app_errors__fatal_app_errors__first_screen_view_name__first_screen_view_transition_type__first_screen_view_type__last_screen_view_name__last_screen_view_transition_type__last_screen_view_type__platform__dvce_screenwidth__dvce_screenheight__device_manufacturer__device_model__os_type__first_os_version__last_os_version__android_idfa__apple_idfa__apple_idfv__open_idfa__geo_country__geo_region__geo_city__geo_zipcode__geo_latitude__geo_longitude__geo_region_name__geo_timezone__first_carrier__last_carrier__first_event_id2__last_event_id2__ref_snowplow_mobile_users_expected_stg_.9e96286350", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_users_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_mobile_dbt_1_snplw_mobile_int_tests.snowplow_mobile_users_expected_stg\n\n),\n\na_minus_b as (\n\n    select user_id, device_user_id, network_userid, start_tstamp, end_tstamp, screen_views, screen_names_viewed, sessions, sessions_duration_s, active_days, app_errors, fatal_app_errors, first_screen_view_name, first_screen_view_transition_type, first_screen_view_type, last_screen_view_name, last_screen_view_transition_type, last_screen_view_type, platform, dvce_screenwidth, dvce_screenheight, device_manufacturer, device_model, os_type, first_os_version, last_os_version, android_idfa, apple_idfa, apple_idfv, open_idfa, geo_country, geo_region, geo_city, geo_zipcode, geo_latitude, geo_longitude, geo_region_name, geo_timezone, first_carrier, last_carrier, first_event_id2, last_event_id2 from a\n    \n\n    except\n\n\n    select user_id, device_user_id, network_userid, start_tstamp, end_tstamp, screen_views, screen_names_viewed, sessions, sessions_duration_s, active_days, app_errors, fatal_app_errors, first_screen_view_name, first_screen_view_transition_type, first_screen_view_type, last_screen_view_name, last_screen_view_transition_type, last_screen_view_type, platform, dvce_screenwidth, dvce_screenheight, device_manufacturer, device_model, os_type, first_os_version, last_os_version, android_idfa, apple_idfa, apple_idfv, open_idfa, geo_country, geo_region, geo_city, geo_zipcode, geo_latitude, geo_longitude, geo_region_name, geo_timezone, first_carrier, last_carrier, first_event_id2, last_event_id2 from b\n\n),\n\nb_minus_a as (\n\n    select user_id, device_user_id, network_userid, start_tstamp, end_tstamp, screen_views, screen_names_viewed, sessions, sessions_duration_s, active_days, app_errors, fatal_app_errors, first_screen_view_name, first_screen_view_transition_type, first_screen_view_type, last_screen_view_name, last_screen_view_transition_type, last_screen_view_type, platform, dvce_screenwidth, dvce_screenheight, device_manufacturer, device_model, os_type, first_os_version, last_os_version, android_idfa, apple_idfa, apple_idfv, open_idfa, geo_country, geo_region, geo_city, geo_zipcode, geo_latitude, geo_longitude, geo_region_name, geo_timezone, first_carrier, last_carrier, first_event_id2, last_event_id2 from b\n    \n\n    except\n\n\n    select user_id, device_user_id, network_userid, start_tstamp, end_tstamp, screen_views, screen_names_viewed, sessions, sessions_duration_s, active_days, app_errors, fatal_app_errors, first_screen_view_name, first_screen_view_transition_type, first_screen_view_type, last_screen_view_name, last_screen_view_transition_type, last_screen_view_type, platform, dvce_screenwidth, dvce_screenheight, device_manufacturer, device_model, os_type, first_os_version, last_os_version, android_idfa, apple_idfa, apple_idfv, open_idfa, geo_country, geo_region, geo_city, geo_zipcode, geo_latitude, geo_longitude, geo_region_name, geo_timezone, first_carrier, last_carrier, first_event_id2, last_event_id2 from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null}], "elapsed_time": 8.932770252227783, "args": {"populate_cache": true, "static_parser": true, "cache_selected_only": false, "partial_parse_file_diff": true, "partial_parse": true, "static": false, "strict_mode": false, "empty_catalog": false, "log_path": "/home/runner/work/dbt-snowplow-mobile/dbt-snowplow-mobile/integration_tests/logs", "show_resource_report": false, "source_freshness_run_project_hooks": false, "invocation_command": "dbt docs generate", "enable_legacy_logger": false, "favor_state": false, "print": true, "printer_width": 80, "project_dir": "/home/runner/work/dbt-snowplow-mobile/dbt-snowplow-mobile/integration_tests", "use_colors_file": true, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "compile": true, "which": "generate", "vars": {}, "write_json": true, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "log_file_max_bytes": 10485760, "version_check": true, "indirect_selection": "eager", "send_anonymous_usage_stats": false, "use_colors": true, "quiet": false, "log_format_file": "debug", "defer": false, "require_resource_names_without_spaces": false, "log_format": "default", "select": [], "log_level": "info", "exclude": [], "introspect": true, "profiles_dir": "./ci"}}