version: 2

models:
  - name: snowplow_mobile_screen_views_actual
    tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('snowplow_mobile_screen_views_expected_stg')
      - dbt_utils.equality:
          compare_model: ref('snowplow_mobile_screen_views_expected_stg')
          # removing model_tstamp
          compare_columns:
            - screen_view_id
            - event_id
            - app_id
            - user_id
            - device_user_id
            - network_userid
            - session_id
            - session_index
            - previous_session_id
            - session_first_event_id
            - screen_view_in_session_index
            - screen_views_in_session
            - dvce_created_tstamp
            - collector_tstamp
            - derived_tstamp
            - screen_view_name
            - screen_view_transition_type
            - screen_view_type
            - screen_fragment
            - screen_top_view_controller
            - screen_view_controller
            - screen_view_previous_id
            - screen_view_previous_name
            - screen_view_previous_type
            - platform
            - dvce_screenwidth
            - dvce_screenheight
            - device_manufacturer
            - device_model
            - os_type
            - os_version
            - android_idfa
            - apple_idfa
            - apple_idfv
            - open_idfa
            - device_latitude
            - device_longitude
            - device_latitude_longitude_accuracy
            - device_altitude
            - device_altitude_accuracy
            - device_bearing
            - device_speed
            - geo_country
            - geo_region
            - geo_city
            - geo_zipcode
            - geo_latitude
            - geo_longitude
            - geo_region_name
            - geo_timezone
            - user_ipaddress
            - useragent
            - carrier
            - network_technology
            - network_type
            - build
            - version
  - name: snowplow_mobile_sessions_actual
    tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('snowplow_mobile_sessions_expected_stg')
      - dbt_utils.equality:
          compare_model: ref('snowplow_mobile_sessions_expected_stg')
          # removing model_tstamp
          compare_columns:
            - app_id
            - session_id
            - session_index
            - previous_session_id
            - session_first_event_id
            - session_last_event_id
            - start_tstamp
            - end_tstamp
            - user_id
            - device_user_id
            - network_userid
            - stitched_user_id
            - session_duration_s
            - has_install
            - screen_views
            - screen_names_viewed
            - app_errors
            - fatal_app_errors
            - first_event_name
            - last_event_name
            - first_screen_view_name
            - first_screen_view_transition_type
            - first_screen_view_type
            - last_screen_view_name
            - last_screen_view_transition_type
            - last_screen_view_type
            - platform
            - dvce_screenwidth
            - dvce_screenheight
            - device_manufacturer
            - device_model
            - os_type
            - os_version
            - android_idfa
            - apple_idfa
            - apple_idfv
            - open_idfa
            - device_latitude
            - device_longitude
            - device_latitude_longitude_accuracy
            - device_altitude
            - device_altitude_accuracy
            - device_bearing
            - device_speed
            - geo_country
            - geo_region
            - geo_city
            - geo_zipcode
            - geo_latitude
            - geo_longitude
            - geo_region_name
            - geo_timezone
            - user_ipaddress
            - useragent
            - name_tracker
            - v_tracker
            - carrier
            - network_technology
            - network_type
            - first_build
            - last_build
            - first_version
            - last_version
  - name: snowplow_mobile_users_actual
    tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('snowplow_mobile_users_expected_stg')
      - dbt_utils.equality:
          compare_model: ref('snowplow_mobile_users_expected_stg')
          # removing model_tstamp
          compare_columns:
            - user_id
            - device_user_id
            - network_userid
            - start_tstamp
            - end_tstamp
            - screen_views
            - screen_names_viewed
            - sessions
            - sessions_duration_s
            - active_days
            - app_errors
            - fatal_app_errors
            - first_screen_view_name
            - first_screen_view_transition_type
            - first_screen_view_type
            - last_screen_view_name
            - last_screen_view_transition_type
            - last_screen_view_type
            - platform
            - dvce_screenwidth
            - dvce_screenheight
            - device_manufacturer
            - device_model
            - os_type
            - first_os_version
            - last_os_version
            - android_idfa
            - apple_idfa
            - apple_idfv
            - open_idfa
            - geo_country
            - geo_region
            - geo_city
            - geo_zipcode
            - geo_latitude
            - geo_longitude
            - geo_region_name
            - geo_timezone
            - first_carrier
            - last_carrier
